(()=>{var e=document.currentScript;define("914330ee-2df2-4f6e-a858-30c23a812408_2.2.20",["tslib","react","react-dom","@microsoft/sp-core-library","@microsoft/sp-diagnostics","@ms/office-ui-fabric-react-bundle","@microsoft/load-themed-styles","@ms/sp-component-utilities","@ms/sp-heading-level","@ms/sp-telemetry","@microsoft/sp-lodash-subset","@ms/sp-fluentui-v9-utilities-bundle","@ms/odsp-utilities-bundle","@ms/sp-fluentui-migration-button-bundle","@odsp-ui/sharepoint-tokens-bundle","@ms/sp-deferred-component","@ms/sp-fluentui-migration-customizer-bundle","@ms/sp-fluentui-migration-tooltip-bundle","@ms/sp-fluentui-migration-link-bundle","@ms/sp-fluentui-migration-reactdom-render-bundle","@microsoft/sp-component-base","@microsoft/sp-page-context","@microsoft/sp-http","@microsoft/sp-webpart-base","@ms/odsp-core-bundle","@ms/i18n-utilities","@microsoft/sp-image-helper","@ms/sp-rich-image","@microsoft/sp-loader"],(t,n,a,i,r,o,s,c,d,l,u,f,p,m,_,h,b,g,v,y,S,D,I,x,C,O,w,E,A)=>(()=>{"use strict";var L,k,M,P={385:(e,t,n)=>{n.d(t,{F6:()=>r,L2:()=>f,MF:()=>c,VH:()=>u,at:()=>l,eB:()=>d,uJ:()=>s,w7:()=>o});var a=n(878),i=n(562);function r(){return a._SPFlight.isEnabled(1671)}function o(){return a._SPFlight.isEnabled(60803)}function s(){return a._SPFlight.isEnabled(1506)}function c(){return a._SPFlight.isEnabled(61874)}function d(){return!(0,i.LX)()&&a._SPFlight.isEnabled(61245)}function l(){return a._SPFlight.isEnabled(61279)}function u(){return!(0,i.YR)()&&a._SPFlight.isEnabled(61245)}function f(){return!(0,i.jD)()&&a._SPFlight.isEnabled(61365)}}
,562:(e,t,n)=>{n.d(t,{$:()=>g,A4:()=>I,Hu:()=>S,KJ:()=>x,LD:()=>p,LX:()=>f,N9:()=>b,Qm:()=>c,Qn:()=>D,YR:()=>m,_2:()=>u,_l:()=>i,a2:()=>s,gC:()=>C,gk:()=>l,j1:()=>y,jD:()=>h,l$:()=>_,nt:()=>o,o3:()=>d,pW:()=>r,w5:()=>v});var a=n(878);function i(){return a._SPKillSwitch.isActivated("b99b1292-77bd-463a-916a-cbd3f8956784")}function r(){return a._SPKillSwitch.isActivated("1df4c4dd-60d6-4b03-a261-0c0f22f3be9d")}function o(){return a._SPKillSwitch.isActivated("49c3a31f-5de7-4e23-9215-e5f14730f38a")}function s(){return a._SPKillSwitch.isActivated("338fd388-0eb2-49e7-85fa-1479bec69e28")}function c(){return a._SPKillSwitch.isActivated("9ccaf499-bc1f-4fa6-8851-59fbba978780")}function d(){return a._SPKillSwitch.isActivated("86ec9359-938c-4ead-a4c1-9ad50be739a1")}function l(){return a._SPKillSwitch.isActivated("cc25329a-3fd2-4808-bcfb-116baf415aeb")}function u(){return a._SPKillSwitch.isActivated("2ab1d078-d1cc-4b4d-a6e0-70f675b13461")}function f(){return a._SPKillSwitch.isActivated("5783d8fc-ae06-4449-a23c-5d6cade2dd6f")}function p(){return a._SPKillSwitch.isActivated("350345ed-21b9-49c5-b631-b6f76ac0116b")}function m(){return a._SPKillSwitch.isActivated("f517f548-0f32-4526-948d-f9422dd06fee")}function _(){return a._SPKillSwitch.isActivated("5bbf2b4f-6aae-4bec-bcca-8864faa6261a")}function h(){return a._SPKillSwitch.isActivated("a01e6fe1-b316-42d2-a59f-1aa60a95f290")}function b(){return a._SPKillSwitch.isActivated("a644c00c-2353-4d37-90c7-1c3587272f6e")}function g(){return a._SPKillSwitch.isActivated("604ff00c-4019-4ef5-8786-0cd214c924f4")}function v(){return a._SPKillSwitch.isActivated("babe9e56-b163-4cd7-8422-b083e93533a0")}function y(){return a._SPKillSwitch.isActivated("a888be6b-db89-4068-83a7-02f00d4fc551")}function S(){return a._SPKillSwitch.isActivated("9c47a7c7-046d-42ec-9c8f-9701e96a16bd")}function D(){return a._SPKillSwitch.isActivated("638bab7f-dbb0-4a6f-986b-21e21e82c8a6")}function I(){return a._SPKillSwitch.isActivated("269bba16-835f-41df-8dbe-8c4c753bf066")}function x(){return a._SPKillSwitch.isActivated("59c340e0-1adf-4253-b404-9c92ef9c6618")}function C(){return a._SPKillSwitch.isActivated("7d7f5920-0181-4820-9225-dfa39e1c9334")}}
,629:(e,t,n)=>{n.d(t,{gM:()=>y,RT:()=>v,XP:()=>S});var a=n(553),i=n(650),r=n(79),o=n(377),s=n(348),c=i.lazy(function(){return n.e(123).then(n.bind(n,396)).then(function(e){return{default:e.default}})});function d(e){return i.createElement(i.Suspense,{fallback:!1},i.createElement(c,(0,a.__assign)({},e)))}var l=n(562),u=n(253),f=n(311),p=n(889),m=n(385),_=(0,f.makeStyles)({});function h(e){var t,n=(i.useContext(p.j)||_)(),a=e.useFigCaptionTag,r=e.content,o=e.styles,s=e.isEditMode,c=(e.useWebpartTitleStyles||_)(),d=(0,f.mergeClasses)(o,"captionElement",s&&n.captionTextEdit,!s&&n.captionTextView,!(0,l._2)()&&(0,m.at)()&&((0,m.VH)()&&!(0,l.N9)()?c.multipleHeader:c.header)),u=!!(0,l.j1)()||""!==(null===(t=r.props)||void 0===t?void 0:t.text)||s;return a?u&&i.createElement("figcaption",{className:d,"data-automation-id":"captionElement"},r):u&&i.createElement("div",{className:d,"data-automation-id":"captionElement"},r)}const b=function(e){function t(t){var n=e.call(this,t)||this;return n._getHeadingStyle=function(e){switch(e){case 2:return u.Z.captionElement__heading2;case 3:return u.Z.captionElement__heading3;case 4:return(0,l.$)()?u.Z.captionElement__heading4Legacy:u.Z.captionElement__heading4;default:return u.Z.captionElement__nonHeading}},n._spanRef=i.createRef(),n}return(0,a.__extends)(t,e),t.prototype.render=function(){return i.createElement("span",{ref:this._spanRef,role:this.props.headingLevel&&"heading",onClick:this.props.handleClick,"aria-level":this.props.headingLevel,id:"CaptionElementView","data-automation-id":(0,l.LD)()||this.props.type!==v.Title?void 0:"webPartTitleReadMode",className:(0,m.VH)()?(0,l.N9)()?this._getHeadingStyle(this.props.headingLevel):"headingLevel-".concat(this.props.headingLevel):void 0,style:{cursor:"text"}},this.props.text,this.props.placeholder&&!this.props.text&&i.createElement("span",null,this.props.placeholder))},t}(r.BaseComponent);var g,v={Caption:1,Title:2},y={PageDirection:1,Center:2};!function(e){e.Read="READ",e.ActiveResponsiveEdit="ACTIVE_RESPONSIVE_EDIT",e.InactiveResponsiveEdit="INACTIVE_RESPONSIVE_EDIT",e.UnresponsiveEdit="UNRESPONSIVE_EDIT"}(g||(g={}));const S=function(e){function t(t){var n=e.call(this,t)||this;return n.focusOnCaptionElement=function(){var e;null===(e=n._textarea)||void 0===e||e.focus()},n._handleActiveEditingUpdate=function(e){n.props.allowResponsiveCaptionHeight&&n.state.isActiveEditing!==e.isActiveEditing&&(n.state.isActiveEditing?n.setState({height:n.state.captionEditingHeight}):n.setState({height:30}))},n._handleCaptionEditingHeightUpdate=function(e){n._getCaptionEditMode()===g.ActiveResponsiveEdit&&n.state.isActiveEditing&&n.state.captionEditingHeight!==e.captionEditingHeight&&n.setState({height:n.state.captionEditingHeight+8})},n._handleHeightUpdate=function(e){n.props.allowResponsiveCaptionHeight&&n.props.onHeightChange&&n.props.onHeightChange(n.state.height)},n._initializeResizeObserver=function(){n._resizeObserver||(n._resizeObserver=new ResizeObserver(function(e){var t=e[0].contentRect.height;n.setState({captionEditingHeight:t})}))},n._cleanUpResizeObserver=function(){n._resizeObserver&&n._resizeObserver.disconnect()},n._handleReceiveRef=function(e){n._textarea=e,n._getCaptionEditMode()===g.ActiveResponsiveEdit&&(n._initializeResizeObserver(),n._resizeObserver.observe(n._textarea),n.focusOnCaptionElement())},n._handleClick=function(e){e.stopPropagation(),n.focusOnCaptionElement()},n._handleChange=function(e){var t=e.target.value;n.setState({text:t},function(){n.props.onChange&&n.props.onChange(t,e)})},n._handleReadModeElementClick=function(e){e.stopPropagation(),n.setState({isActiveEditing:!0})},n._handleFocus=function(){n.props.moduleName&&n.props.isEditMode&&(n._initialValue=n.state.text)},n._handleBlur=function(){if(n.setState({isActiveEditing:!1}),n.props.moduleName&&n.props.isEditMode){var e=void 0,t=n.state.text;n._initialValue!==t&&(e=0===t.length?"Clear":n._initialValue&&0!==n._initialValue.length?"Edit":"Add",o._EngagementLogger.logEventWithLogEntry(new o._LogEntry(n.props.moduleName,"CaptionElement",o._LogType.Event,{action:e,length:t.length.toString()})))}},n.state={text:t.text,height:38,captionEditingHeight:38,isActiveEditing:!1},n}return(0,a.__extends)(t,e),t.prototype.UNSAFE_componentWillReceiveProps=function(e){this.setState({text:e.text})},t.prototype.componentDidUpdate=function(e,t){this._handleActiveEditingUpdate(t),this._handleCaptionEditingHeightUpdate(t),this._handleHeightUpdate(t)},t.prototype.componentDidMount=function(){this.props.allowResponsiveCaptionHeight&&this._initializeResizeObserver()},t.prototype.componentWillUnmount=function(){this.props.allowResponsiveCaptionHeight&&this._cleanUpResizeObserver()},t.prototype.render=function(){var e,t,n,o,s,c,d=(0,r.css)(((e={})[u.Z.captionElement__NoMargin]=!this.props.marginBottomSize||"None"===this.props.marginBottomSize,e),((t={})[u.Z.captionElement__MiddleMargin]="Middle"===this.props.marginBottomSize,t),((n={})[u.Z.captionElement__LargeMargin]="Large"===this.props.marginBottomSize,n)),f=(0,r.mergeStyles)(this.props.type===v.Caption&&u.Z.captionElement__caption,this.props.type===v.Title&&u.Z.captionElement__title,this.props.type===v.Title&&(c={theme:(0,r.getTheme)()},{title:(0,a.__assign)({},c.theme.fonts.xLarge)}).title,u.Z.thick),p=(0,r.css)(((o={})[u.Z.captionElement__leftAlign]=this.props.alignPosition===y.PageDirection,o),((s={})[u.Z.captionElement__centerAlign]=this.props.alignPosition===y.Center,s)),m=u.Z.titleBreakInLines,_=(0,r.css)(d,f,p,m,this.props.className),b=this._getCaptionEditMode(),S=!1===this.props.isTitleEditable||b!==g.UnresponsiveEdit&&b!==g.ActiveResponsiveEdit?this._renderViewMode:this._renderEditMode;return(0,l.gk)()?this.props.useFigCaptionTag?i.createElement("figcaption",{className:_,"data-automation-id":"captionElement"},S):i.createElement("div",{className:_,"data-automation-id":"captionElement"},S):i.createElement(h,{useFigCaptionTag:this.props.useFigCaptionTag,content:S,styles:_,isEditMode:this.props.isEditMode,useWebpartTitleStyles:this.props.useWebpartTitleStyles})},t.prototype.value=function(){return this.state.text},t.prototype._getCaptionEditMode=function(){return this.props.isEditMode?!0===this.props.allowResponsiveCaptionHeight?this.state.isActiveEditing?g.ActiveResponsiveEdit:g.InactiveResponsiveEdit:g.UnresponsiveEdit:g.Read},Object.defineProperty(t.prototype,"_renderEditMode",{get:function(){return i.createElement(d,{handleChange:this._handleChange,placeholder:this.props.placeholder,text:this.state.text,handleFocus:this._handleFocus,handleBlur:this._handleBlur,handleClick:this._handleClick,receiveElement:this._handleReceiveRef,type:(0,l.a2)()?v.Title:this.props.type||v.Title,ariaLabel:this.props.ariaLabel,headingLevel:this.props.headingLevel})},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_renderViewMode",{get:function(){var e=this.props.headingLevel;return i.createElement(b,{headingLevel:e,pageContext:this.props.pageContext,text:this.state.text,type:this.props.type,handleClick:this.props.allowResponsiveCaptionHeight?this._handleReadModeElementClick:void 0,placeholder:this.props.placeholder})},enumerable:!1,configurable:!0}),t.defaultProps={isEditMode:!1,text:void 0,onChange:s.noop,placeholder:void 0,type:v.Caption,alignPosition:y.Center,allowResponsiveCaptionHeight:!1},t}(r.BaseComponent)}
,889:(e,t,n)=>{n.d(t,{j:()=>r});var a=n(650),i=n(311),r=a.createContext((0,i.makeStyles)({}))}
,253:(e,t,n)=>{n.d(t,{Z:()=>a}),n(230).loadStyles('.a_a_658c9e0a{font-size:14px;font-weight:400;font-weight:300;line-height:1.6em;overflow-x:hidden;text-overflow:ellipsis}.a_a_658c9e0a.b_a_658c9e0a{font-weight:400}.c_a_658c9e0a{font-size:28px!important}.e_a_658c9e0a{font-size:24px!important}.f_a_658c9e0a{font-size:20px!important}.g_a_658c9e0a{font-size:18px!important}.h_a_658c9e0a{font-size:14px}.i_a_658c9e0a{color:"[theme:neutralPrimary, default: #323130]";overflow:hidden;text-overflow:ellipsis}[dir=ltr] .j_a_658c9e0a{text-align:left}[dir=rtl] .j_a_658c9e0a{text-align:right}.k_a_658c9e0a{text-align:center}[dir=ltr] .l_a_658c9e0a{text-align:right}[dir=rtl] .l_a_658c9e0a{text-align:left}.m_a_658c9e0a{margin-bottom:18px}.n_a_658c9e0a{margin-bottom:11px}.o_a_658c9e0a{margin-bottom:0}.p_a_658c9e0a{white-space:pre-wrap}.q_a_658c9e0a{background-color:transparent;border:none;box-sizing:border-box;display:block;font-family:inherit;font-size:inherit;font-weight:inherit;line-height:inherit;margin:0;outline:0;overflow:hidden;resize:none;text-align:inherit;width:100%}.q_a_658c9e0a.b_a_658c9e0a{font-weight:400}.q_a_658c9e0a:-ms-input-placeholder{color:"[theme:neutralTertiary, default: #a19f9d]"}.q_a_658c9e0a::placeholder{color:"[theme:neutralTertiary, default: #a19f9d]"}',!0);const a={captionElement__caption:"a_a_658c9e0a",thick:"b_a_658c9e0a",captionElement__heading2:"c_a_658c9e0a",captionElement__heading3:"e_a_658c9e0a",captionElement__heading4:"f_a_658c9e0a",captionElement__heading4Legacy:"g_a_658c9e0a",captionElement__nonHeading:"h_a_658c9e0a",captionElement__title:"i_a_658c9e0a",captionElement__leftAlign:"j_a_658c9e0a",captionElement__centerAlign:"k_a_658c9e0a",captionElement__rightAlign:"l_a_658c9e0a",captionElement__LargeMargin:"m_a_658c9e0a",captionElement__MiddleMargin:"n_a_658c9e0a",captionElement__NoMargin:"o_a_658c9e0a",titleBreakInLines:"p_a_658c9e0a",textarea:"q_a_658c9e0a"}}
,230:e=>{e.exports=s},866:e=>{e.exports=S},878:e=>{e.exports=i},377:e=>{e.exports=r},272:e=>{e.exports=I},137:e=>{e.exports=w},37:e=>{e.exports=A},348:e=>{e.exports=u},171:e=>{e.exports=D},134:e=>{e.exports=x},111:e=>{e.exports=O},362:e=>{e.exports=C},616:e=>{e.exports=p},79:e=>{e.exports=o},962:e=>{e.exports=c},933:e=>{e.exports=h},8:e=>{e.exports=m},559:e=>{e.exports=b},163:e=>{e.exports=v},541:e=>{e.exports=y},533:e=>{e.exports=g},311:e=>{e.exports=f},280:e=>{e.exports=d},89:e=>{e.exports=E},186:e=>{e.exports=l},152:e=>{e.exports=_},650:e=>{e.exports=n},729:e=>{e.exports=a},553:e=>{e.exports=t}},T={};function U(e){var t=T[e];if(void 0!==t)return t.exports;var n=T[e]={exports:{}};return P[e](n,n.exports,U),n.exports}U.m=P,U.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return U.d(t,{a:t}),t},U.d=(e,t)=>{for(var n in t)U.o(t,n)&&!U.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},U.f={},U.e=e=>Promise.all(Object.keys(U.f).reduce((t,n)=>(U.f[n](e,t),t),[])),U.u=e=>"chunk."+({123:"sp-caption-element-edit",505:"live-persona-card-loader",557:"sp-fabric-teaching-bubble",869:"sp-edit-utilities"}[e]||e)+"_"+({123:1}[e]?"en-us":"none")+"_"+{123:"66332bfcfd758bcf5181",296:"a626489e3078840ad27b",505:"86fd2fe67b6c4e2a59d1",557:"f51a810a9c2f6a82e000",869:"e428d11aae304a331cf7"}[e]+".js",U.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),L={},k="914330ee-2df2-4f6e-a858-30c23a812408_2.2.20:",U.l=(e,t,n,a)=>{if(L[e])L[e].push(t);else{var i,r;if(void 0!==n)for(var o=document.getElementsByTagName("script"),s=0;s<o.length;s++){var c=o[s];if(c.getAttribute("src")==e||c.getAttribute("data-webpack")==k+n){i=c;break}}i||(r=!0,(i=document.createElement("script")).charset="utf-8",i.timeout=120,U.nc&&i.setAttribute("nonce",U.nc),i.setAttribute("data-webpack",k+n),i.src=e,0!==i.src.indexOf(window.location.origin+"/")&&(i.crossOrigin="anonymous")),L[e]=[t];var d=(t,n)=>{i.onerror=i.onload=null,clearTimeout(l);var a=L[e];if(delete L[e],i.parentNode&&i.parentNode.removeChild(i),a&&a.forEach(e=>e(n)),t)return t(n)},l=setTimeout(d.bind(null,void 0,{type:"timeout",target:i}),12e4);i.onerror=d.bind(null,i.onerror),i.onload=d.bind(null,i.onload),r&&document.head.appendChild(i)}},U.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},M=e?e.src:"",U.p=M.slice(0,M.lastIndexOf("/")+1),U.f.compat=(e,t)=>{for(var n=function(e){return{557:[{i:"17ce0976-e69a-4355-be84-89b69a74717d",v:"0.3.14",m:853}],505:[{i:"a68dd513-949e-48c1-b210-23ad37dbbe13",v:"0.1.0",m:934}],869:[{i:"c79b9f88-6338-40fb-b463-3aad22a88b15",v:"0.1.0",m:656}]}[e]||[]}(e),a=0;a<n.length;a++)U.m[n[a].m]||(e=>{t.push(F.SPComponentLoader.loadComponentById(e.i,e.v).then(t=>{U.m[e.m]=e=>e.exports=t}))})(n[a])};var F=U(37);(()=>{var e={173:0};U.f.j=(t,n)=>{var a=U.o(e,t)?e[t]:void 0;if(0!==a)if(a)n.push(a[2]);else{var i=new Promise((n,i)=>a=e[t]=[n,i]);n.push(a[2]=i);var r=U.p+U.u(t),o=new Error;U.l(r,n=>{if(U.o(e,t)&&(0!==(a=e[t])&&(e[t]=void 0),a)){var i=n&&("load"===n.type?"missing":n.type),r=n&&n.target&&n.target.src;o.message="Loading chunk "+t+" failed.\n("+i+": "+r+")",o.name="ChunkLoadError",o.type=i,o.request=r,a[1](o)}},"chunk-"+t,t)}};var t=(t,n)=>{var a,i,[r,o,s]=n,c=0;if(r.some(t=>0!==e[t])){for(a in o)U.o(o,a)&&(U.m[a]=o[a]);s&&s(U)}for(t&&t(n);c<r.length;c++)i=r[c],U.o(e,i)&&e[i]&&e[i][0](),e[i]=0},n=self["webpackJsonp_914330ee-2df2-4f6e-a858-30c23a812408_2.2.20"]=self["webpackJsonp_914330ee-2df2-4f6e-a858-30c23a812408_2.2.20"]||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var H={};return(()=>{U.r(H),U.d(H,{BaseCollection:()=>N,BaseCollectionWebPart:()=>le,BaseDataWebPart:()=>me,BaseEmphasisComponentStyles:()=>Me,BaseFirstPartyWebPart:()=>re,CalculatedField:()=>Ae,CaptionElement:()=>b.XP,CaptionElementAlignPosition:()=>b.gM,CaptionElementStylesContext:()=>fe.j,CaptionElementType:()=>b.RT,CustomerPromiseUtilities:()=>ue,DateBox:()=>Ie,DateBoxSize:()=>Se,DisplayFieldMap:()=>ke,DoughboyDetector:()=>ze,EditModeUtilitiesLoader:()=>yt,FreshDataRenderFailure:()=>oe,LINK_FIELDNAME_SUFFIX:()=>Le,LessText:()=>Ge,LivePersonaCard:()=>gt,MappedField:()=>Ee,MySiteWebPartCacheHelper:()=>K,MySiteWebPartCacheManager:()=>X,OAuthErrorRenderer:()=>et,PageType:()=>g,Pagination:()=>D,Parallax:()=>rt,Placeholder:()=>Ze,RefreshType:()=>se,TextClamp:()=>Xe,TopicCardHoverTarget:()=>vt,WebPartChrome:()=>T,WebPartDataProvider:()=>pe,WebPartTitle:()=>ft,WebViewUtility:()=>pt,_topActionsFieldConverter:()=>ot,_topActionsFieldsConverter:()=>st,clampElement:()=>Je,clampText:()=>Ye,getEmbedOverlay:()=>St,getRelativeDateTimeStringForLists:()=>we,getUrlTarget:()=>Te,handleItemNavigation:()=>Pe,isAmplifyHostType:()=>Ot,isApplySpdsFontTokenEnabled:()=>x.at,isApplySpdsFontTokenWave2Enabled:()=>x.L2,isEmailHostType:()=>Dt,isEmailOrTeamsHostType:()=>xt,isExternalUrl:()=>Ue,isFluentVNextAllSpEnabled:()=>x.w7,isMainCanvasHostType:()=>Ct,isModifyFontSizeTitleHeadingsEnabled:()=>x.VH,isPersonalCacheFlightEnabled:()=>x.F6,isRedeemableShareLink:()=>ct,isSameDay:()=>he,isTeamsHostType:()=>It,isUseNewRequestWebPartCacheDataEnabled:()=>x.MF,isWebPartGroupEnabledCachingEnabled:()=>x.uJ,isWebPartTitleHeadingsEnabled:()=>x.eB,redeemShareLink:()=>dt,truncateText:()=>Ke,webPartPreviewThumbnail:()=>He});var e=U(553),t=U(650),n=U(729),a=U(541),i=U(878),r=U(377),o=U(79),s=U(559),c=U(230);(0,c.loadStyles)([{rawString:".ms-odsp-screenReaderAlert{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);border:0}"}]);const d=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,e.__extends)(n,t),n.read=function(e,t){if(e){var a=document.createTextNode(e);n._getDedicatedDomNode(t||1).appendChild(a)}},n._getDedicatedDomNode=function(e){n._alertNode&&document.body.removeChild(n._alertNode);var t=document.createElement("div");switch(t.setAttribute("data-automation-id","screen-reader-alert-static"),t.classList.add("ms-odsp-screenReaderAlert"),e){case 1:t.setAttribute("aria-live","polite");break;case 2:t.setAttribute("role","alert"),t.setAttribute("aria-live","assertive")}return document.body.appendChild(t),n._alertNode=t,n._alertNode},n.prototype.componentDidMount=function(){n.read(this.props.message,this.props.readingMode)},n.prototype.componentDidUpdate=function(e){e.message===this.props.message&&e.indicator===this.props.indicator||n.read(this.props.message,this.props.readingMode)},n.prototype.render=function(){return!1},n}(t.PureComponent);var l=U(962),u=U(280),f=U(186),p=U(533),m=U(8),_=U(163),h=U(348),b=U(629),g={Default:0,Prev:1,Next:2},v=U(616);const y=JSON.parse('{"K3":"Page {0}","Fi":"Previous","$0":"Next","Xz":"Go to the {0} page, you are currently on page {1}.","ex":"Go to the {0} page."}');c.loadStyles('.ag_f_658c9e0a{border:1px solid transparent;margin:0;min-width:240px;padding:2px 0;position:relative;text-align:center;width:100%}.ag_f_658c9e0a .ms-Icon{line-height:inherit}[dir=ltr] .ag_f_658c9e0a [data-icon-name=ChevronLeft]{margin-left:0}[dir=ltr] .ag_f_658c9e0a [data-icon-name=ChevronRight],[dir=rtl] .ag_f_658c9e0a [data-icon-name=ChevronLeft]{margin-right:0}[dir=rtl] .ag_f_658c9e0a [data-icon-name=ChevronRight]{margin-left:0}.ag_f_658c9e0a button{cursor:pointer;cursor:hand;display:none;font-size:14px;font-weight:400;height:32px!important;margin:0 8px;outline:none;padding:8px 4px;position:relative}.ag_f_658c9e0a:not(.ah_f_658c9e0a) button:active{background:"[theme:white, default: #ffffff]"}.ag_f_658c9e0a .ai_f_658c9e0a,.ag_f_658c9e0a .aj_f_658c9e0a{border:none;display:inline-block;margin:0}.ag_f_658c9e0a .ai_f_658c9e0a i,.ag_f_658c9e0a .aj_f_658c9e0a i{margin:0 10px;position:relative;top:2px}.ag_f_658c9e0a .ak_f_658c9e0a{border-bottom:2px solid!important;color:"[theme:black, default: #000000]";cursor:default;height:20px;position:relative;top:-2px}.ag_f_658c9e0a .ak_f_658c9e0a.al_f_658c9e0a{border:1px dotted!important;border-bottom:3px solid!important}[dir=ltr] .am_f_658c9e0a{text-align:left}[dir=rtl] .am_f_658c9e0a{text-align:right}[dir=ltr] .am_f_658c9e0a .aj_f_658c9e0a{float:right}[dir=rtl] .am_f_658c9e0a .aj_f_658c9e0a{float:left}@media only screen and (min-width:640px){.ag_f_658c9e0a button{display:inline-block}}',!0);const S=function(n){function a(){var e=null!==n&&n.apply(this,arguments)||this;return e._handleClick=function(){e.props.onClick(e.props.pageNumber,e.props.pageType)},e._handleKeyDown=function(t){e.props.onKeyDown(t,e.props.pageNumber,e.props.pageType)},e}return(0,e.__extends)(a,n),a.prototype.render=function(){var n,a=this.props.pageType===g.Prev,i=this.props.pageType===g.Next,r=(0,o.css)(((n={}).ak_f_658c9e0a=this.props.selected,n.ai_f_658c9e0a=a,n.aj_f_658c9e0a=i,n),this.props.className);return t.createElement(m.ActionButton,(0,e.__assign)({className:r,ariaLabel:this._pageAriaLabel,disabled:this.props.disabled,onClick:this._handleClick},this.props.onKeyDown?{onKeyDown:this._handleKeyDown}:{}),a&&t.createElement(o.Icon,{iconName:v.Locale.isRightToLeft?"ChevronRight":"ChevronLeft","aria-hidden":"true"}),this.props.text,i&&t.createElement(o.Icon,{iconName:v.Locale.isRightToLeft?"ChevronLeft":"ChevronRight","aria-hidden":"true"}))},Object.defineProperty(a.prototype,"_pageAriaLabel",{get:function(){return this.props.pageNumber?this.props.pageType===g.Default?v.StringHelper.format(y.K3,this.props.pageNumber):v.StringHelper.format(y.Xz,this.props.text,this.props.pageNumber):v.StringHelper.format(y.ex,this.props.text)},enumerable:!1,configurable:!0}),a}(t.PureComponent),D=function(n){function a(){var e=null!==n&&n.apply(this,arguments)||this;return e._handleClick=function(t,n){e.props.onPageChange(t,n)},e._handleKeyDown=function(t,n,a){e.props.onPageChangeWithKeyDown(t,n,a)},e}return(0,e.__extends)(a,n),a.prototype.render=function(){var e,n=(0,o.css)("ag_f_658c9e0a",((e={}).am_f_658c9e0a=!this.props.showPageNum,e.ah_f_658c9e0a=!0,e),this.props.className);return 0===this.props.itemsCount?void 0:t.createElement("div",{className:n},this._pages)},Object.defineProperty(a.prototype,"_pages",{get:function(){var n=[],a=Math.ceil(this.props.itemsCount/this.props.itemsPerPage),i=this.props.pageLength,r=this.props.currentPage;r<1&&(r=1),r>a&&(r=a);var o=Math.max(1,r-Math.floor(i/2)),s=Math.min(a,r+Math.floor(i/2));s-o+1<i&&(r<a/2?s=Math.min(a,i+o):o=Math.max(1,s-i)),s-o+1>i&&(r>a/2?o++:s--);var c=r-1>0?r-1:r,d=r===s?s:r+1;if(n.push(t.createElement(S,(0,e.__assign)({className:this.props.pageClassName,key:y.Fi+c,text:y.Fi,pageType:g.Prev,pageNumber:this.props.showPageNum?c:void 0,selected:!1,disabled:this.props.showPageNum?1===r:!this.props.hasPrevPage,onClick:this._handleClick},this.props.onPageChangeWithKeyDown?{onKeyDown:this._handleKeyDown}:{}))),this.props.showPageNum)for(var l=o;l<=s;l++){var u="".concat(l);n.push(t.createElement(S,(0,e.__assign)({key:u+l,text:u,pageType:g.Default,pageNumber:l,selected:r===l,disabled:!1,onClick:this._handleClick},this.props.onPageChangeWithKeyDown?{onKeyDown:this._handleKeyDown}:{})))}return n.push(t.createElement(S,(0,e.__assign)({key:y.$0+d,text:y.$0,pageType:g.Next,pageNumber:this.props.showPageNum?d:void 0,selected:!1,disabled:this.props.showPageNum?r===s:!this.props.hasNextPage,onClick:this._handleClick},this.props.onPageChangeWithKeyDown?{onKeyDown:this._handleKeyDown}:{}))),n},enumerable:!1,configurable:!0}),a}(t.PureComponent);var I=U(152),x=U(385),C=U(562);const O=function(){function t(){}return t.getStyles=function(t){var n=t.theme,a=n.semanticColors;return{title:[{selectors:{"& span":{color:a.bodyText},"& textarea":{color:n.semanticColors.bodyText+" !important"},"& textarea::placeholder":{color:n.semanticColors.bodySubtext+" !important"}}}],add:[{color:a.bodyText,selectors:(0,e.__assign)({"& .ms-Button-icon":{color:a.link},"&:hover .ms-Button-icon, &:active .ms-Button-icon, &:focus .ms-Button-icon":{color:a.linkHovered+" !important"},"& .ms-Button-label":{color:a.actionLink},"&:hover .ms-Button-label, &:active .ms-Button-label, &:focus .ms-Button-label":{color:a.actionLinkHovered+" !important"},"& .ms-Button-menuIcon":{color:a.bodySubtext},"&:hover .ms-Button-menuIcon, &:active .ms-Button-menuIcon, &:focus .ms-Button-menuIcon":{color:a.bodySubtext+" !important"}},(0,C.A4)()?{}:{"& .ms-Button-label":(0,e.__assign)({},I.typographyStyles.body1Strong)})}],addDisabled:[(0,e.__assign)((0,e.__assign)((0,e.__assign)((0,e.__assign)({color:a.disabledBodyText},(0,C.Qn)()?{}:{"&.fui-Button":{selectors:{"&:hover":{color:a.disabledBodyText,backgroundColor:"unset"},"&:hover:active":{color:a.disabledBodyText,backgroundColor:"unset"}}}}),{"& .ms-Button-icon":{color:a.disabledBodyText},"& .ms-Button-menuIcon":{color:a.disabledBodyText}}),(0,C.Hu)()?{}:{"&, .ms-Button-icon, .ms-Button-menuIcon":{"@media screen and (-ms-high-contrast: active), (forced-colors: active)":{color:"GrayText"}}}),(0,C.A4)()?{}:{"& .ms-Button-label":(0,e.__assign)({},I.typographyStyles.body1Strong)})],seeAll:[(0,e.__assign)({color:a.link,selectors:{"&:hover, &:active":{color:a.linkHovered},"&:focus":{color:a.link}}},(0,x.L2)()?(0,e.__assign)({},I.typographyStyles.body1Strong):{})],seeAllDisabled:[(0,e.__assign)((0,e.__assign)({color:a.disabledBodyText},(0,x.L2)()?(0,e.__assign)({},I.typographyStyles.body1Strong):{}),{selectors:{"@media screen and (-ms-high-contrast: active), (forced-colors: active)":{color:"GrayText"}},"&:hover":{color:a.disabledBodyText}})]}},t.getClassNames=(0,o.classNamesFunction)(),t}(),w=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,e.__extends)(n,t),n.prototype._internalLoad=function(){return U.e(557).then(U.bind(U,437)).then(function(e){return e.TeachingBubble})},n}(U(933)._DeferredComponent),E=JSON.parse('{"Et":"See all","lc":"See all {0}","fT":"See all {0} in the {1} webpart","Vp":"See all disabled","G5":"Add","Iv":"Add an item","zy":"Close teaching bubble","GT":"The See All page for the {0} web part is opening.","t$":"Navigate back to the source page"}');c.loadStyles('.aq_h_658c9e0a{align-items:stretch;display:flex;flex-direction:column}.ar_h_658c9e0a{align-items:baseline;display:flex}.as_h_658c9e0a{order:2;width:100%}.at_h_658c9e0a{flex-grow:1}[dir=ltr] .at_h_658c9e0a{margin-right:32px}[dir=rtl] .at_h_658c9e0a{margin-left:32px}.ms-Button.au_h_658c9e0a,.ms-Button.fui-Button.au_h_658c9e0a{border:0;height:auto;margin-bottom:23px}[dir=ltr] .ms-Button.au_h_658c9e0a,[dir=ltr] .ms-Button.fui-Button.au_h_658c9e0a{padding-left:0}[dir=rtl] .ms-Button.au_h_658c9e0a,[dir=rtl] .ms-Button.fui-Button.au_h_658c9e0a{padding-right:0}[dir=ltr] .ms-Button.au_h_658c9e0a .ms-Icon,[dir=ltr] .ms-Button.fui-Button.au_h_658c9e0a .ms-Icon{margin-left:0}[dir=rtl] .ms-Button.au_h_658c9e0a .ms-Icon,[dir=rtl] .ms-Button.fui-Button.au_h_658c9e0a .ms-Icon{margin-right:0}.ms-Button.av_h_658c9e0a{background-color:transparent;height:35px;margin-bottom:5px;margin-top:-9px}.ms-Button.aw_h_658c9e0a .ms-Button-icon,.ms-Button.aw_h_658c9e0a:hover .ms-Button-label{color:"[theme:themePrimary, default: #0078d4]"}.ax_h_658c9e0a{white-space:nowrap}[dir=ltr] .ax_h_658c9e0a{margin-left:auto}[dir=rtl] .ax_h_658c9e0a{margin-right:auto}.ax_h_658c9e0a:focus{-webkit-text-decoration-line:underline;text-decoration-line:underline}.CanvasSection--edit .at_h_658c9e0a{flex-shrink:0}.ay_h_658c9e0a{margin-bottom:18px}.az_h_658c9e0a{margin-bottom:11px}.ba_h_658c9e0a{margin-bottom:0}.bb_h_658c9e0a{background-color:#fff}',!0);const A="at_h_658c9e0a",L="au_h_658c9e0a";var k=U(311),M=(0,k.makeStyles)({header:{"&.captionElement":{"& #CaptionElementView":(0,e.__assign)((0,e.__assign)({},I.typographyStyles.custom.webPartHeader),{fontFamily:"var(--fontFamilyCustomFont1300, ".concat(k.typographyStyles.subtitle1.fontFamily,")"),fontWeight:"var(--fontWeightCustomFont1300, ".concat(k.typographyStyles.subtitle1.fontWeight,")")}),"& #CaptionElementEdit":(0,e.__assign)((0,e.__assign)({},I.typographyStyles.custom.webPartHeader),{fontFamily:"var(--fontFamilyCustomFont1300, ".concat(k.typographyStyles.subtitle1.fontFamily,")"),fontWeight:"var(--fontWeightCustomFont1300, ".concat(k.typographyStyles.subtitle1.fontWeight,")")})}},multipleHeader:{"&.captionElement":{"& .headingLevel-2":(0,e.__assign)({},I.typographyStyles.custom.title2),"& .headingLevel-3":(0,e.__assign)({},I.typographyStyles.custom.title3),"& .headingLevel-4":(0,e.__assign)({},I.typographyStyles.custom.subtitle1)}}}),P={iconName:"ChevronLeft"};const T=function(n){function a(e){var t=n.call(this,e)||this;return t._isFluentUIShimPerfImprovementKillSwitchActivated=(0,C.l$)(),t._handleClick=function(e){var n=t.props,a=n.seeAllLink,r=n.webPartAlias;a.teachingBubble&&!t.state.isTeachingBubbleDismissed&&t._onDismissTeachingBubble(),(0,C.gC)()?l.ScreenReaderAlert.read(i.Text.format(E.GT,r||""),l.ReadingMode.ReadImmediately):d.read(i.Text.format(E.GT,r||""),2),a.onClick(e)},t._onDismissTeachingBubble=function(){var e=t.props.seeAllLink;t._isMounted&&t.setState({isTeachingBubbleDismissed:!0}),e&&e.teachingBubble.onDismiss()},t._handleSeeAllLinkKeyDown=function(e){e.keyCode===o.KeyCodes.enter&&((0,C.gC)()?l.ScreenReaderAlert.read(i.Text.format(E.GT,t.props.webPartAlias||""),l.ReadingMode.ReadImmediately):d.read(i.Text.format(E.GT,t.props.webPartAlias||""),2))},t.state={isTeachingBubbleDismissed:!1,settings:{theme:e.theme}},t}return(0,e.__extends)(a,n),Object.defineProperty(a.prototype,"_classNames",{get:function(){var e=this.props.theme;return Boolean(e)&&O.getClassNames(O.getStyles,{root:"webPartChrome",theme:e})},enumerable:!1,configurable:!0}),a.prototype.componentDidMount=function(){this._isMounted=!0},a.prototype.componentWillUnmount=function(){this._isMounted=!1},a.prototype.render=function(){var e,n=this.props,a=n.dataAutomationId,i=n.forceContrastBackground,r=n.seeAllLink,c=n.showTitle,d=r&&r.show||c,l=t.createElement("div",{"data-automation-id":a,className:(0,o.css)("aq_h_658c9e0a",(e={},e.bb_h_658c9e0a=i,e))},t.createElement("div",{className:d?"ar_h_658c9e0a":"","data-automation-id":d?"webPartHeader":""},this._renderTitle(),this._renderSeeAllLink()),this._renderContent(),this._renderTeachingBubble());return this.props.theme?t.createElement(s.Customizer,{settings:this._isFluentUIShimPerfImprovementKillSwitchActivated?{theme:this.props.theme}:this.state.settings},l):l},a.prototype.focusOnTitle=function(){this._captionElement&&this._captionElement.focusOnCaptionElement()},a.prototype._renderTitle=function(){var e,n=this.props,a=n.customTitle,i=n.isEditMode,r=n.onTitleChange,s=n.placeholder,c=n.showTitle,d=n.title,l=n.titleAlignment,f=n.isTitleEditable,_=n.isSeeAllPage,g=n.headingLevel;if(!(0,C._l)()&&_){var v=new URL(window.location.href).searchParams.get("Page");v&&((0,C.pW)()||this._isSafeUrl(v))&&(e=t.createElement(p.TooltipHost,{content:E.t$},t.createElement(m.IconButton,{iconProps:P,href:v,ariaLabel:E.t$})))}return c?t.createElement(t.Fragment,null,e,a||t.createElement(b.XP,{className:(0,o.css)(this._classNames&&this._classNames.title,A),ref:this._resolveRef("_captionElement"),type:b.RT.Title,isEditMode:i,text:d,onChange:r||h.noop,placeholder:s,alignPosition:l||b.gM.PageDirection,headingLevel:(0,x.eB)()&&g||u._DEFAULT_HEADING_LEVEL,marginBottomSize:this._titleMarginBottomSize,isTitleEditable:f,useWebpartTitleStyles:M})):t.createElement("div",{className:A})},a.prototype._isSafeUrl=function(e){try{return 0===new URL(e).protocol.indexOf("http")}catch(e){return!1}},a.prototype._renderContent=function(){var n=this.props,a=n.contentElement,i=n.pagination,r=n.panelElement;return t.createElement("div",{className:"as_h_658c9e0a"},this._renderAddButton(),a,r,i&&t.createElement(D,(0,e.__assign)({},i)))},Object.defineProperty(a.prototype,"_titleMarginBottomSize",{get:function(){var e=this.props,t=e.addButton,n=e.seeAllLink,a=e.showTitle,i=e.titleMarginBottomSize;return void 0!==i?i:n&&n.show||a?t.show?"Middle":"Large":"None"},enumerable:!1,configurable:!0}),a.prototype._renderSeeAllLink=function(){var e,n=this.props.seeAllLink;switch(this._titleMarginBottomSize){case"Large":e="ay_h_658c9e0a";break;case"Middle":e="az_h_658c9e0a";break;case"None":e="ba_h_658c9e0a"}var a=(0,C.KJ)()?i.Text.format(E.lc,this.props.webPartAlias||""):i.Text.format(E.fT,this.props.title||"",this.props.webPartAlias||"");return n&&n.show&&n.href&&t.createElement("span",{className:e,ref:this._resolveRef("_teachingBubbleTargetElement")},t.createElement(_.Link,{"aria-label":n.ariaLabel||(n.disabled?E.Vp:a),className:(0,o.css)(this._classNames&&(n.disabled?this._classNames.seeAllDisabled:this._classNames.seeAll),"ax_h_658c9e0a"),disabled:n.disabled,onClick:this._handleClick,onKeyDown:this._handleSeeAllLinkKeyDown,"data-interception":"propagate","data-automation-id":n.automationId,id:n.id,"data-sp-action":n.action,href:n.href},n.label||E.Et))},a.prototype._renderTeachingBubble=function(){var e=this.props.seeAllLink.teachingBubble;return this._showTeachingBubble&&!this.state.isTeachingBubbleDismissed?t.createElement(w,{deferredProps:{headline:e.headline,targetElement:this._teachingBubbleTargetElement,onDismiss:this._onDismissTeachingBubble,hasCloseIcon:!0,calloutProps:{doNotLayer:!1,gapSpace:2,isBeakVisible:!0,directionalHint:o.DirectionalHint.topAutoEdge},primaryButtonProps:e.primaryButtonProps,closeButtonAriaLabel:E.zy}},e.text):void 0},Object.defineProperty(a.prototype,"_showTeachingBubble",{get:function(){var e=this.props.seeAllLink;return Boolean(e&&e.teachingBubble&&e.teachingBubble.show)},enumerable:!1,configurable:!0}),a.prototype._renderAddButton=function(){var n=this.props.addButton;if(n&&n.show){var a={ariaLabel:n.ariaLabel||E.Iv,ariaDescription:n.ariaDescription,disabled:n.disabled,iconProps:{iconName:"CalculatorAddition"},label:n.label||E.G5,"data-automation-id":n.automationId,"data-interception":"propagate"};return n.menuProps?t.createElement(m.DefaultButton,(0,e.__assign)({},a,{className:(0,o.css)(this._classNames?n.disabled?this._classNames.addDisabled:this._classNames.add:"aw_h_658c9e0a",L,"av_h_658c9e0a"),menuProps:n.menuProps,styles:{label:{fontWeight:400}}}),a.label):t.createElement(m.ActionButton,(0,e.__assign)({},a,{className:(0,o.css)(this._classNames&&(n.disabled?this._classNames.addDisabled:this._classNames.add),L),href:n.href,onClick:n.onClick}),a.label)}},a.defaultProps={isEditMode:!1,seeAllLink:{show:!1},addButton:{show:!1},contentElement:t.createElement("div",null)},a.getDerivedStateFromProps=function(t,n){var a=n;return(0,C.l$)()||(0,h.isEqual)(t.theme,n.settings.theme)||(a=(0,e.__assign)((0,e.__assign)({},n),{settings:{theme:t.theme}})),a},a}(o.BaseComponent);function F(){return!i._SPKillSwitch.isActivated("9da07b7d-b53a-4c3d-bced-36f541fd231f")}const R=JSON.parse('{"_f":"The page context is not provided by the host environment.","MA":"The page context does not provide a web instance.","iP":"The page context does not provide a web identifier.","J4":"The page context does not provide a site instance.","Dw":"The page context does not provide a site identifier.","vF":"A data source is required.","K9":"Title","Y6":"We didn\\u0027t find anything to show here.","Py":"A layout is required.","Ko":"Highlighted Content"}');c.loadStyles('.an_g_658c9e0a{color:"[theme:neutralPrimary, default: #323130]"}.ao_g_658c9e0a{margin-bottom:5px}.ap_g_658c9e0a a::-moz-focus-inner,.ap_g_658c9e0a button::-moz-focus-inner{border:0}.ap_g_658c9e0a a,.ap_g_658c9e0a button{outline:transparent;position:relative}.ap_g_658c9e0a.ms-Fabric.is-focusVisible a:focus:after,.ap_g_658c9e0a.ms-Fabric.is-focusVisible button:focus:after,.ms-Fabric.is-focusVisible .ap_g_658c9e0a a:focus:after,.ms-Fabric.is-focusVisible .ap_g_658c9e0a button:focus:after{border:1px solid "[theme:neutralsecondary, default: #605e5c]";border-radius:inherit;bottom:0;content:"";left:0;pointer-events:none;position:absolute;right:0;top:0}',!0);const N=function(c){function p(e){var n=c.call(this,e)||this;return n._webPartChromeRef=t.createRef(),n._isMounted=!1,n._handleTitleChange=function(e){n.props.onTitleChange(e)},n._layoutContainerRef=t.createRef(),n}return(0,e.__extends)(p,c),p.prototype.componentDidMount=function(){this._isMounted=!0;var e=this.props.onComponentMounted;!this._isDynamicLayout&&e&&e()},p.prototype.componentWillUnmount=function(){var e;this._isMounted=!1,(null===(e=this._layoutContainerRef)||void 0===e?void 0:e.current)&&(n.unmountComponentAtNode(this._layoutContainerRef.current),this._layoutContainerRef=void 0)},p.prototype.render=function(){var e,n=this.props,a=n.addButton,s=n.defaultTitle,c=n.displayMode,d=n.emphasisTheme,l=n.errorCallback,u=n.hideWebPartWhenEmpty,f=n.isRenderedFromCacheData,p=n.paginationProps,m=n.panelElement,_=n.qosPrefix,h=n.seeAllLink,b=n.isTitleEditable,g=n.changeVisibility,v=n.isSeeAllPage,y=new r._QosMonitor("".concat(_,"ComponentRender")),S=this._renderEmptyResult(y),D=f?"BaseCollection-Cache":"BaseCollection-FreshData";S||this._renderLayout();try{!u||!S||h&&h.show||c!==i.DisplayMode.Read?(e=t.createElement(o.Fabric,null,t.createElement(T,{addButton:a,contentElement:this._renderWebPartDisplay(S),dataAutomationId:D,forceContrastBackground:!1,isEditMode:c===i.DisplayMode.Edit,onTitleChange:this._handleTitleChange,pagination:p,panelElement:m,placeholder:s,ref:this._webPartChromeRef,seeAllLink:h,showTitle:this._shouldShowTitle,theme:d,title:this._title,isTitleEditable:b,isSeeAllPage:v,webPartAlias:this._webPartAlias,headingLevel:this._getHeadingLevel}),this._dialogRef?t.createElement("div",{ref:this._dialogRef}):void 0),null==g||g(!0)):(e=!1,null==g||g(!1))}catch(e){l(e),y.writeUnexpectedFailure("FailedToRender",e)}return y.writeSuccess(),e},p.prototype.focusOnTitle=function(){var e=this._webPartChromeRef.current;e&&e.focusOnTitle()},Object.defineProperty(p.prototype,"_hasEmptyResponse",{get:function(){var e=this.props.items;return!!e&&e.length<1},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"_emptyResponseText",{get:function(){var e=this.props,t=e.displayMode,n=e.hasInitialLoadingState,a=e.hideWebPartWhenEmpty,r=e.emptyResponseText;if(this._hasEmptyResponse&&!n){if(a&&t===i.DisplayMode.Read)return;return r||R.Y6}},enumerable:!1,configurable:!0}),p.prototype._renderEmptyResult=function(e){var n=this.props,a=n.errorCallback,i=n.hasInitialLoadingState,r=n.layoutInfo;if(this._hasEmptyResponse&&!i)try{var o=r&&r.id||"",s=F()&&this.props.emphasisTheme?"":"an_g_658c9e0a",c=F()?{color:this.props.emphasisTheme.palette.neutralPrimary}:{};return t.createElement("span",{className:s,"data-automation-id":"".concat(o,"-no-results"),style:c},this._emptyResponseText)}catch(t){a(t),e.writeUnexpectedFailure("FailedToRenderEmptyResult")}},p.prototype._renderLayout=function(){var n=this,i=this.props,o=i.emphasisTheme,c=i.errorCallback,d=i.layoutInfo,l=i.onComponentMounted,u=i.qosPrefix;f._PerformanceLogger.saveTempData("".concat(this.props.webPartTag,".loadLayoutStart"),f._PerformanceLogger.now());var p=new r._QosMonitor("".concat(u,"ComponentRenderLayout"));this._isDynamicLayout=!0,d.loadLayout().then(function(i){var r;if(n._isMounted){f._PerformanceLogger.saveTempData("".concat(n.props.webPartTag,".loadLayoutEnd"),f._PerformanceLogger.now());var c=t.createElement(i,n.props);if(o){var d={settings:{theme:o}};c=t.createElement(s.Customizer,(0,e.__assign)({},d),c)}var u=function(){p.writeSuccess(),l&&l()};(null===(r=n._layoutContainerRef)||void 0===r?void 0:r.current)?a.render(c,n._layoutContainerRef.current,u):u(),f._PerformanceLogger.saveTempData("".concat(n.props.webPartTag,".syncLayoutRenderComplete"),f._PerformanceLogger.now())}}).catch(function(e){c(e),p.writeUnexpectedFailure("FailedToRenderLayout",e)})},Object.defineProperty(p.prototype,"_webPartAlias",{get:function(){var e=this.props.webPartTag.split(".")[1];return"ContentRollupWebPart"===e?R.Ko:e},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"_title",{get:function(){var e=this.props,t=e.defaultTitle,n=e.displayMode,a=e.displayPlaceholderTitleInReadMode,r=e.title;return n===i.DisplayMode.Read&&a&&!r?t:r||""},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"_shouldShowTitle",{get:function(){var e=this.props,t=e.displayMode,n=e.hasInitialLoadingState,a=e.showTitle,r=n||!this._hasEmptyResponse||Boolean(this._emptyResponseText);return a&&t===i.DisplayMode.Edit||r&&a&&!!this._title},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"_getHeadingLevel",{get:function(){var e=this.props.headingLevel;return(0,x.eB)()?e||u._DEFAULT_HEADING_LEVEL:void 0},enumerable:!1,configurable:!0}),p.prototype._renderWebPartDisplay=function(e){var n=this.props,a=n.addToPageScreenReaderLabel,r=n.displayMode,s=n.messageView,c=n.renderedOnce;return t.createElement("div",null,r===i.DisplayMode.Edit&&!c&&a&&((0,C.gC)()?t.createElement(l.ScreenReaderAlert,{readingMode:l.ReadingMode.ReadImmediately,message:a}):t.createElement(d,{readingMode:2,message:a})),s&&t.createElement(o.MessageBar,{className:"ao_g_658c9e0a",ariaLabel:s.ariaLabel,messageBarType:s.messageBarType},s.message),e||t.createElement("div",{ref:this._layoutContainerRef}))},p}(o.BaseComponent);var B=U(866),j=U(171),V=U(272),z="SP.ResourcePath",G="/_api/SP.UserProfiles.PersonalCache",K=function(){function e(){}return e.getRemoteSubfolderCreateUrl=function(e,t,n,a){i.Validate.isNonemptyString(e,"currentWebAbsoluteUrl"),i.Validate.isNonemptyString(t,"remoteWebAbsoluteUrl"),i.Validate.isNonemptyString(n,"remoteParentFolderRelativeUrl"),i.Validate.isNonemptyString(a,"remoteFolderName");var r=v.UriEncoding.encodeRestUriStringToken(t),o=v.UriEncoding.encodeRestUriStringToken(n),s=v.UriEncoding.encodeRestUriStringToken(a);return v.Uri.concatenate(v.Uri.concatenate(v.Uri.concatenate(e,"/_api/SP.RemoteWeb(@remoteWeb)"),"/Web/GetFolderByServerRelativePath(DecodedUrl=@parentFolderRelativeUrl)"),"/AddSubFolder(@subfolderTitle)")+"?@remoteWeb='".concat(r,"'")+"&@parentFolderRelativeUrl='".concat(o,"'")+"&@subfolderTitle='".concat(s,"'")},e.getUrlLastSegment=function(e){return i.Validate.isNonemptyString(e,"url"),new v.Uri(e).getLastPathSegment()},e.getUrlWithoutLastSegment=function(e){i.Validate.isNonemptyString(e,"url");var t=e.lastIndexOf("/");return t>-1?e.substring(0,t):e},e.getPersonalCacheItemCreateUrl=function(e){i.Validate.isNonemptyString(e,"currentWebAbsoluteUrl");var t=(0,x.F6)()?"/ReadCacheOrCreate2":"/ReadCacheOrCreate";return v.Uri.concatenate(v.Uri.concatenate(e,G),t)},e.getPersonalCacheItemUpdateUrl=function(e){i.Validate.isNonemptyString(e,"currentWebAbsoluteUrl");var t=(0,x.F6)()?"/WriteCache2":"/WriteCache";return v.Uri.concatenate(v.Uri.concatenate(e,G),t)},e.getPersonalCacheItemDeleteUrl=function(e){i.Validate.isNonemptyString(e,"currentWebAbsoluteUrl");var t=(0,x.F6)()?"/DeleteCacheItemsAsync2":"/DeleteCacheItemsAsync";return v.Uri.concatenate(v.Uri.concatenate(e,G),t)},e.dateTimeStringToJsDate=function(e){i.Validate.isNonemptyString(e,"dateTime");var t=e.split(/[^0-9]/);return t.length<6?void 0:new Date(Date.UTC(Number(t[0]),Number(t[1])-1,Number(t[2]),Number(t[3]),Number(t[4]),Number(t[5])))},e.checkStatus=function(e){return i.Validate.isNotNullOrUndefined(e,"response"),e.status>=200&&e.status<300?Promise.resolve(e):Promise.reject(new Error(JSON.stringify(e)))},e.checkFolderStatus=function(e){return i.Validate.isNotNullOrUndefined(e,"response"),e.status>=200&&e.status<300||500===e.status?Promise.resolve(e):Promise.reject(new Error(JSON.stringify(e)))},e.getCreatePersonalCacheItemBody=function(e,t,n){i.Validate.isNonemptyString(e,"listRelativeFolderPath"),i.Validate.isNotNullOrUndefined(t,"items");var a="";t.forEach(function(e){""!==a&&(a+=", "),a+=e.CacheKey});var r={folderPath:{__metadata:{type:"".concat(z)},DecodedUrl:"".concat(e)},requiredCacheKeys:["".concat(a)],createIfMissing:!0};return n&&(0,x.F6)()&&(r.mySiteUrl=n),r},e.getReadPersonalCacheItemBody=function(e,t,n){i.Validate.isNonemptyString(e,"listRelativeFolderPath"),i.Validate.isNotNullOrUndefined(t,"instanceIds");var a={folderPath:{__metadata:{type:"".concat(z)},DecodedUrl:"".concat(e)},requiredCacheKeys:t,createIfMissing:!1};return n&&(0,x.F6)()&&(a.mySiteUrl=n),a},e.getUpdatePersonalCacheItemsBody=function(e,t,n){i.Validate.isNotNullOrUndefined(e,"items");var a=[];e.forEach(function(e){n&&(e.CacheValue=""),a.push(e)});var r={cacheItems:a};return t&&(0,x.F6)()&&(r.mySiteUrl=t),r},e.post=function(e,t,n,a){return i.Validate.isNotNullOrUndefined(e,"spHttpClient"),i.Validate.isNonemptyString(t,"url"),i.Validate.isNotNullOrUndefined(n,"body"),e.post(t,V.SPHttpClient.configurations.v1,{body:JSON.stringify(n),headers:{"OData-Version":"3.0"}}).then(a)},e.generateHash=function(e){return(0,l.Md5Hash)(e)},e.getDateNowAsUTC=function(){var e=new Date;return new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds()))},e.addSecondsToDate=function(e,t){i.Validate.isNotNullOrUndefined(e,"date"),i.Validate.isNotNullOrUndefined(t,"seconds");var n=new Date(e.toString());return n.setTime(n.getTime()+1e3*t),n},e.isExpired=function(t,n,a){return t&&n&&a&&a>0&&t>e.addSecondsToDate(n,a)},e}(),W="2.0",q="1.5",Q="MySiteWebPartCacheDataProvider.",Y="MySiteWebPartCacheDataProvider",J=function(){function t(e){var n=this;this._cacheItemsMap=new Map,this._cacheItemVersionMap=new Map,this._hasFlushCompleted=!1,this._hasInitializedSynchronously=!1,this._updateRemoteCacheItemsAPI=function(e,t){i.Validate.isNotNullOrUndefined(e,"absoluteUrl"),i.Validate.isNotNullOrUndefined(t,"items");var a="_writeCache",o=new r._QosMonitor(Q+a);f._PerformanceLogger.startMarkForComponent(a),n._updateLocalItems(t);var s,c=K.getPersonalCacheItemUpdateUrl(e),d=K.getUpdatePersonalCacheItemsBody(t,n._mySiteAbsoluteUrl);return s={count:t.length,dataSizeInKB:JSON.stringify(t).length/1024},K.post(n._spHttpClient,c,d,K.checkStatus).then(function(e){return o.writeSuccess(s),f._PerformanceLogger.endMarkForComponent(a),e}).catch(function(e){return o.writeUnexpectedFailure("WriteCacheError",e,s),f._PerformanceLogger.endMarkForComponent(a),Promise.reject(e)})},this._updateRemotePersonalCacheItems=function(){t._itemsToDeferUpdate.size>0&&(t._itemsToDeferUpdate.forEach(function(e,a){n._updateRemoteCacheItemsAPI(a,e).catch(function(e){return r._TraceLogger.logError(t._logSource,e,"UpdateRemoteCacheItems")})}),t._itemsToDeferUpdate.clear())},this._remoteUpdater=function(e){n._updateRemotePersonalCacheItems(),e||(n._writeCacheTimer=n._async.setTimeout(n._remoteUpdater,1e4))},this._hookUnloadEvent=function(){window.addEventListener("beforeunload",n._emergencyUpload)},this._unhookUnloadEvent=function(){window.removeEventListener("beforeunload",n._emergencyUpload)},this._emergencyUpload=function(){n._remoteUpdater(!0),n._unhookUnloadEvent(),n._writeCacheTimer&&n._async.clearTimeout(n._writeCacheTimer)},f._PerformanceLogger.startMarkForComponent(Y),this._async=new o.Async(this);var a=function(){var e=new r._QosMonitor(Q+"_tryInitializeFromLateFlush");try{n._tryInitializeFromPage(),n._hasFlushCompleted?e.writeSuccess():e.writeUnexpectedFailure("NoCacheMetadata")}catch(t){e.writeUnexpectedFailure("CatchAll",t)}},s=t._increaseLateFlushKS()?12e4:24e4,c=0;this._initializeFromLateFlush=new Promise(function(e,t){var i=new r._QosMonitor(Q+"_initializeFromLateFlush");window._spWebPartDataLoaded||(window._spWebPartDataLoaded=a);var d=new o.Async;d.setInterval(function(){return!n._hasFlushCompleted&&window._spWebPartData&&a(),n._hasFlushCompleted&&window._spWebPartData?(f._PerformanceLogger.markComponent(Y,n._hasInitializedSynchronously?"SyncFlushCompleted":"LateFlushCompleted"),i.writeSuccess({initializedAsync:!n._hasInitializedSynchronously}),d.dispose(),e()):c>=s?(f._PerformanceLogger.endMarkForComponent(Y),i.writeUnexpectedFailure("TimedOut"),d.dispose(),(0,C.Qm)()?t():t(new Error)):void(c+=50)},50)}),e.whenFinished(function(){n._pageContext=e.consume(j.PageContext.serviceKey),n._spHttpClient=e.consume(V.SPHttpClient.serviceKey),n._tryInitializeSynchronously(),n._remoteUpdater(),n._hookUnloadEvent(),r._EngagementLogger.logEvent("MySiteWebPartCacheDataProvider.Constructor")})}return t._increaseLateFlushKS=function(){return i._SPKillSwitch.isActivated("ab30cf50-82cc-4361-9270-edce465b67d7")},Object.defineProperty(t.prototype,"currentListRelativeFolderPath",{get:function(){return this._currentListRelativeFolderPath},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"currentWebAbsoluteUrl",{get:function(){return this._currentWebAbsoluteUrl},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"mySiteAbsoluteUrl",{get:function(){return this._mySiteAbsoluteUrl},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasFlushCompleted",{get:function(){return this._hasFlushCompleted},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"initializeFromLateFlush",{get:function(){return this._initializeFromLateFlush},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"currentPageCacheFolderKey",{set:function(e){this._currentPageCacheFolderKey=e,this._currentListRelativeFolderPath=this._getListRelativeFolderPath()},enumerable:!1,configurable:!0}),t.prototype.getCacheItemVersion=function(e){return this._cacheItemVersionMap.get(e)},t.prototype.getWebPartIdLogObject=function(e,t,n,a){return{alias:e,instanceId:t,isSmartRaceEnabled:this._isMySiteCacheSmartRaceRefactorEnabled(),cacheStatus:n,serverStatus:a}},t.prototype._internalAdvancedGetCachedData=function(e,t){var n=this._getCachedItem(e);if(n&&n.hash===t)return JSON.parse(n.result)},t.prototype._internalAdvancedSetCacheData=function(e,t,n){this._tryUpdateCache(e.instanceId,e.manifest.alias,n,t)},t.prototype.getWebPartData=function(n,a,o,s,c,d,l,u){var f=this;void 0===d&&(d=!0),void 0===l&&(l=-1),i.Validate.isNotNullOrUndefined(n,"requestData"),i.Validate.isNotNullOrUndefined(a,"dataUpdated"),i.Validate.isNotNullOrUndefined(o,"config"),i.Validate.isNonemptyString(s,"webPartInstanceId"),i.Validate.isNonemptyString(c,"webPartAlias");var p=new r._QosMonitor(Q+"getWebPartData"),m="",_=void 0,h=this._getCachedItem(s),b=K.generateHash(JSON.stringify(o));u=u||"WebPart.".concat(c,".internal.").concat(s),this._logCacheStart(s,u,"MySiteWebPartCacheDataProvider.GetWebPartData"),this._captureCacheKeyUsageTelemetry(c,b);var g=!!h&&b!==h.hash;if(!h||g){this._logCacheMiss(u),this._logConfigMismatch(u,h,!g);var v=n(),y=v.then(function(e){r._TraceLogger.logVerbose(t._logSource,"CacheMiss: Requested cached item for ".concat(u," doesn't exist. Creating.")),_=e,m=JSON.stringify(_),f._tryUpdateCache(s,c,m,b,h?h.id:void 0),p.writeSuccess(f.getWebPartIdLogObject(c,s))}).catch(function(e){r._TraceLogger.logError(t._logSource,e,"getWebPartData: error while processing non-cached item for ".concat(u,".")),p.writeUnexpectedFailure("NewItemRequestSaveRenderError",e,f.getWebPartIdLogObject(c,s))}).then(function(){return _});if(this._hasFlushCompleted)return y;this._logLateFlush(u);var S=this._initializeFromLateFlush.then(function(){return f._getCachedItem(s)}).then(function(e){return f._canUseCachedData_deprecated(e,o,l)?f._returnCachedDataWithRefresh(e,function(){return v},a,o,s,c,p,b,d,l):(r._TraceLogger.logVerbose(t._logSource,"Late flush resulted in a miss ".concat(c,".").concat(s)),y)});return Promise.race([S,y])}if(K.isExpired(this._utcTimeStamp,h.modified,l))return this._logCacheExpired(u),n().then(function(e){_=e,m=JSON.stringify(_),f._tryUpdateCache(s,c,m,b,h.id),p.writeSuccess(f.getWebPartIdLogObject(c,s))}).catch(function(e){r._TraceLogger.logError(t._logSource,e,"getWebPartData: error while processing cached WebPart item ".concat(s,".")),p.writeUnexpectedFailure("ExpiredCacheUpdateError",e,f.getWebPartIdLogObject(c,s))}).then(function(){return _});try{if(b===h.hash)return this._returnCachedDataWithRefresh(h,n,a,o,s,c,p,b,d,l)}catch(e){r._TraceLogger.logError(t._logSource,e,"getWebPartData: error while processing cache item request for ".concat(u,".")),p.writeUnexpectedFailure("CachedItemUpdateError",e,this.getWebPartIdLogObject(c,s))}finally{if(this._logCacheHit(u),i._SPKillSwitch.isActivated("0fe47b1a-30bf-4b3f-996e-2fe421296166"))return Promise.resolve(JSON.parse(h.result));var D=(0,e.__assign)((0,e.__assign)({},JSON.parse(h.result)),{isFromCustomCache:!0});return Promise.resolve(D)}},t.prototype.getCacheData=function(e){var t=this,n=e.dataUpdated,a=e.serializedConfiguration,r=e.webPartAlias,o=e.webPartInstanceId,s=e.secondsToInvalidate,c=e.requestData;i.Validate.isNotNullOrUndefined(c,"requestData"),i.Validate.isNotNullOrUndefined(n,"dataUpdated"),i.Validate.isNotNullOrUndefined(a,"serializedConfiguration"),i.Validate.isNonemptyString(r,"webPartAlias"),i.Validate.isNonemptyString(o,"webPartInstanceId");var d=this._getCachedItem(o),u=K.generateHash(a),f="WebPart.".concat(r,".internal.").concat(o);this._logCacheStart(o,f,"MySiteWebPartCacheDataProvider.GetCacheData");var p={cacheResponseType:l.CacheResponseType.ServerData,serverResponseAsync:Promise.reject().catch(function(e){return e})};if(p.serverResponseAsync=this._tryUpdateCacheAsync(c,n,r,o,u),this._canUseCachedData(d,u,s,f))return p.cacheResponseType=l.CacheResponseType.CachedData,p.cacheResponseAsync=Promise.resolve(JSON.parse(d.result)),Promise.resolve(p);if(this._logCacheMiss(f),!this._hasFlushCompleted){this._logLateFlush(f);var m=this._initializeFromLateFlush.then(function(){return t._getCachedItem(o)}).then(function(e){return t._canUseCachedData(e,u,s,f)&&(p.cacheResponseType=l.CacheResponseType.CachedData,p.cacheResponseAsync=Promise.resolve(JSON.parse(e.result))),Promise.resolve(p)}),_=i.Guid.parse("f45cfbcb-6bff-4e57-93d9-5427a620ab01"),h=i.Guid.parse("4bba5b4c-4f1a-4639-9512-3abc0226331a"),b=[{raceablePromise:m.then(function(e){return e.cacheResponseAsync||e.serverResponseAsync}),raceId:_},{raceablePromise:p.serverResponseAsync,raceId:h}];return l.SmartRace.race(b).then(function(e){return{cacheResponseType:e.raceId===_?l.CacheResponseType.CachedData:l.CacheResponseType.ServerData,cacheResponseAsync:e.raceId===_?e.raceablePromise:void 0,serverResponseAsync:p.serverResponseAsync}}).catch(function(e){throw t._logSmartRaceError(e),e})}return p.cacheResponseType=l.CacheResponseType.ServerData,Promise.resolve(p)},t.prototype._tryUpdateCacheAsync=function(e,t,n,a,i){var r=this;return e().then(function(e){t&&t(e);var o=JSON.stringify(e);return r._tryUpdateCache(a,n,o,i),e})},t.prototype._canUseCachedData=function(e,t,n,a){var i=!!e&&(e.hash===t||e.cacheVersion===W);if(this._logConfigMismatch(a,e,i),e){var r=K.isExpired(this._utcTimeStamp,e.modified,n);if(r&&this._logCacheExpired(a),i&&!r)return this._logCacheHit(a),!0}return!1},t.prototype._canUseCachedData_deprecated=function(e,t,n){return void 0===n&&(n=-1),!(!e||e.hash!==K.generateHash(JSON.stringify(t))&&e.cacheVersion!==W||K.isExpired(this._utcTimeStamp,e.modified,n))},t.prototype._returnCachedDataWithRefresh=function(n,a,o,s,c,d,l,u,f,p){var m=this;void 0===f&&(f=!0),void 0===p&&(p=-1);var _="",h=void 0;if(r._TraceLogger.logVerbose(t._logSource,"Found cached item ".concat(c," with matching config.")),a().then(function(e){h=e,_=JSON.stringify(h),n.result!==_?(r._TraceLogger.logVerbose(t._logSource,"Requested item ".concat(c," has newer results; updating.")),m._saveRenderAndUpdateItem(o,f,h,c,d,_,u,n.id),l.writeSuccess(m.getWebPartIdLogObject(d,c)),m._logCacheMatchApiResult(d,!1)):(r._TraceLogger.logVerbose(t._logSource,"Requested cached item ".concat(c," has matching result; No write back.")),l.writeSuccess(m.getWebPartIdLogObject(d,c)),m._logCacheMatchApiResult(d,!0))}).catch(function(e){r._TraceLogger.logError(t._logSource,e,"getWebPartData: error while processing cached WebPart item ".concat(c,".")),l.writeUnexpectedFailure("CachedItemUpdatedResultError",e,m.getWebPartIdLogObject(d,c))}),i._SPKillSwitch.isActivated("0fe47b1a-30bf-4b3f-996e-2fe421296166"))return Promise.resolve(JSON.parse(n.result));var b=(0,e.__assign)((0,e.__assign)({},JSON.parse(n.result)),{isFromCustomCache:!0});return Promise.resolve(b)},t.prototype._logCacheMatchApiResult=function(e,t){r._EngagementLogger.logEventWithLogEntry(new r._LogEntry("MySiteWebPartValidCache_deprecated",e,r._LogType.Event,{CacheMatchApiResult:t?"Match":"Not match"}))},t.prototype._saveRenderAndUpdateItem=function(e,t,n,a,r,o,s,c){i.Validate.isNotNullOrUndefined(e,"dataUpdated"),i.Validate.isNotNullOrUndefined(t,"rerender"),i.Validate.isNotNullOrUndefined(n,"response"),i.Validate.isNonemptyString(a,"webPartInstanceId"),i.Validate.isNonemptyString(r,"webPartAlias"),i.Validate.isNonemptyString(o,"rawResponseString"),i.Validate.isNonemptyString(s,"webPartHash"),i.Validate.isNotNullOrUndefined(c,"cacheItemId"),t&&e(n),this._updateCache(a,r,o,s,c)},t.prototype._tryInitializeSynchronously=function(){var e=new r._QosMonitor(Q+"_initialize"),n="Page ".concat(this._currentPageCacheFolderKey," is missing _spPageContextInfo."),a="Page ".concat(this._currentPageCacheFolderKey," has not yet gotten the LKG flush.");this._pageContext?(this._getPrefetchedPageContextProperties(this._pageContext.legacyPageContext),this._tryInitializeFromPage()?(this._hasInitializedSynchronously=!0,f._PerformanceLogger.markComponent(Y,"SyncFlushCompleted"),e.writeSuccess()):(f._PerformanceLogger.markComponent(Y,"DelayedFlush"),r._TraceLogger.logError(t._logSource,new Error,a),e.writeExpectedFailure("DelayedFlush",new Error))):(f._PerformanceLogger.markComponent(Y,"SyncMissingContextInfo"),r._TraceLogger.logError(t._logSource,new Error,n),e.writeUnexpectedFailure("SPPageContextInfoError",new Error))},t.prototype._tryInitializeFromPage=function(){return!!this._hasFlushCompleted||(window._spWebPartData&&(this._getPrefetchedWebPartDataProperties(window._spWebPartData.Properties),this._getPrefetchedWebPartDataItems(window._spWebPartData.Items),this._hasFlushCompleted=!0),this._hasFlushCompleted)},t.prototype._getCachedItem=function(e){return this._cacheItemsMap.get(e)},t.prototype._getPrefetchedWebPartDataProperties=function(e){i.Validate.isNotNullOrUndefined(e,"data"),this._mySiteAbsoluteUrl=e.MySiteUrl,this._currentPageCacheFolderKey=e.PageCacheFolderKey,this._webPartCachePath=e.WebPartCachePath,e.UtcTimeStamp&&(this._utcTimeStamp=K.dateTimeStringToJsDate(e.UtcTimeStamp)),this._currentListRelativeFolderPath=this._getListRelativeFolderPath()},t.prototype._getPrefetchedPageContextProperties=function(e){i.Validate.isNotNullOrUndefined(e,"data"),i.Validate.isNonemptyString(e.webAbsoluteUrl,"data.webAbsoluteUrl"),this._currentWebAbsoluteUrl=e.webAbsoluteUrl},t.prototype._getPrefetchedWebPartDataItems=function(e){var t=this;i.Validate.isNotNullOrUndefined(e,"data"),Object.keys(e).forEach(function(n){var a={webPartInstanceId:n,result:e[n].Value,hash:e[n].HashCode,id:Number(e[n].ID),uniqueId:i.Guid.parse(e[n].UniqueId),modified:K.dateTimeStringToJsDate(e[n].Modified),cacheVersion:e[n].CacheVersion};if(a.cacheVersion===q||a.cacheVersion===W){var r="";try{r=JSON.parse(e[n].AltTitle).id}catch(t){r=e[n].AltTitle}a.webPartInstanceId=r,t._cacheItemVersionMap.set(r,a.cacheVersion),t._cacheItemsMap.set(r,a)}else t._cacheItemVersionMap.set(n,a.cacheVersion),t._cacheItemsMap.set(n,a)}),this._logCacheItemSize()},t.prototype._ensureFlush=function(){return this._hasFlushCompleted?Promise.resolve():this._initializeFromLateFlush},t.prototype._createRemoteCacheItem=function(e,t,n){var a=this;i.Validate.isNonemptyString(e,"title"),i.Validate.isNonemptyString(t,"value"),i.Validate.isNonemptyString(n,"hash");var r=[],o={AltTitle:void 0,CacheValue:t,CacheValueHash:n,ListItemId:void 0,ListItemUniqueId:void 0,CacheVersion:void 0,CacheKey:e,ModifiedTimeUtc:void 0,ContainerUrl:void 0,CacheName:void 0};return r.push(o),this._ensureFlush().then(function(){return a._createPersonalCacheItemsAPI(a._currentListRelativeFolderPath,r)}).then(function(e){if(e)return a._createLocalCacheItemFromServerResponse(e)})},t.prototype._createPersonalCacheItemsAPI=function(e,t){var n=this;i.Validate.isNonemptyString(e,"listRelativeFolderPath"),i.Validate.isNotNullOrUndefined(t,"items");var a=K.getPersonalCacheItemCreateUrl(this._currentWebAbsoluteUrl),r=K.getCreatePersonalCacheItemBody(e,t,this._mySiteAbsoluteUrl);return K.post(this._spHttpClient,a,r,K.checkStatus).then(function(e){return e.json()}).then(function(e){i.Validate.isNotNullOrUndefined(e,"data");var a=t[0],r=[],o={AltTitle:void 0,CacheValue:a.CacheValue,CacheValueHash:a.CacheValueHash,ListItemId:e.value[0].ListItemId,ListItemUniqueId:e.value[0].ListItemUniqueId,CacheVersion:"1.0",CacheKey:a.CacheKey,ModifiedTimeUtc:e.value[0].ModifiedTimeUtc,ContainerUrl:void 0,CacheName:void 0};(0,C.w5)()||(o.ContainerUrl=e.value[0].ContainerUrl,o.CacheName=e.value[0].CacheName),r.push(o),n._createLocalItems(r),n._addItemToBeUpdated(n._currentWebAbsoluteUrl,o)})},t.prototype._updateRemoteCacheItem=function(e,t,n,a){i.Validate.isNonemptyString(e,"cacheKey"),i.Validate.isNonemptyString(n,"hash"),i.Validate.isNotNullOrUndefined(a,"itemID"),t||(t="");var r={AltTitle:void 0,CacheValue:t,CacheValueHash:n,ListItemId:a,ListItemUniqueId:void 0,CacheVersion:"1.0",CacheKey:e,ModifiedTimeUtc:void 0,ContainerUrl:void 0,CacheName:void 0};return(0,C.w5)()||(r.ContainerUrl=this._currentListRelativeFolderPath),this._cacheItemVersionMap.get(e)===W&&(r.AltTitle=JSON.stringify({id:e}),r.CacheVersion=q),[].push(r),this._addItemToBeUpdated(this._currentWebAbsoluteUrl,r),Promise.resolve()},t.prototype._addItemToBeUpdated=function(e,n){if(t._itemsToDeferUpdate.has(e)){var a=t._itemsToDeferUpdate.get(e),i=(0,h.findIndex)(a,function(e){return n.CacheKey===e.CacheKey});i>=0?a[i]=n:a.push(n)}else t._itemsToDeferUpdate.set(e,[n])},t.prototype._updateCache=function(e,n,a,o,s){var c=this;i.Validate.isNonemptyString(e,"webPartInstanceId");var d=e,l=new r._QosMonitor(Q+"_updateCache"),u="UnknownError",f=this._getCachedItem(d);if(f&&f.hash===o&&f.result===a)return u="NoOp",void l.writeExpectedFailure(u,void 0,this.getWebPartIdLogObject(n,e));try{var p=void 0;this._cacheItemsMap.has(d)?(r._TraceLogger.logVerbose(t._logSource,"Updating Cache Item ".concat(d,".")),u="UpdateCacheItemError",void 0===s&&(s=this._getCachedItem(d).id),p=this._updateRemoteCacheItem(d,a,o,s)):(r._TraceLogger.logVerbose(t._logSource,"Creating Cache Item ".concat(d,".")),u="CreateCacheItemError",p=this._createRemoteCacheItem(d,a,o)),p.then(function(){l.writeSuccess(c.getWebPartIdLogObject(n,e))}).catch(function(a){r._TraceLogger.logError(t._logSource,a,"_updateCache: ".concat(u," WebPart: ").concat(e," Page: ").concat(c._currentPageCacheFolderKey)),l.writeUnexpectedFailure(u,a,c.getWebPartIdLogObject(n,e))})}catch(t){l.writeUnexpectedFailure(u,t,this.getWebPartIdLogObject(n,e))}},t.prototype._tryUpdateCache=function(e,n,a,i,o){try{this._updateCache(e,n,a,i,o)}catch(n){r._TraceLogger.logError(t._logSource,n,"getWebPartData: error while processing item ".concat(e,"."))}},t.prototype._createLocalCacheItemFromServerResponse=function(e){var n=this;i.Validate.isNotNullOrUndefined(e,"response");var a,o=new r._QosMonitor(Q+"_createCacheItemInMap"),s="UnknownError";return e.json().then(function(t){var r,c,d,l,u,f,p;i.Validate.isNotNullOrUndefined(t,"data"),i.Validate.isNotNullOrUndefined(t.value,"data.value");var m=K.getDateNowAsUTC();if(s="ResponseParseError",Object.keys(t.value).forEach(function(e){switch(f=t.value[e].FieldName,p=t.value[e].FieldValue,f){case"Id":c=+p;break;case"Title":a=p;break;case"AltTitle":r=p;break;case"HashCode":d=p;break;case"CacheVersion":l=p;break;case"Value":u=p}}),s="CreateCacheItemMapError",!n._cacheItemsMap.has(a)){var _={webPartInstanceId:a,result:u,hash:d,id:c,modified:m,cacheVersion:l};_.cacheVersion===q||_.cacheVersion===W?(_.webPartInstanceId=r,n._cacheItemVersionMap.set(r,_.cacheVersion),n._cacheItemsMap.set(r,_)):(n._cacheItemVersionMap.set(a,_.cacheVersion),n._cacheItemsMap.set(a,_))}return n._logCacheItemSize(),o.writeSuccess(),e}).catch(function(e){return r._TraceLogger.logError(t._logSource,e,"_createCacheItemInMap: error client caching response for WebPart: ".concat(a)),o.writeUnexpectedFailure(s,e),Promise.resolve(void 0)})},t.prototype._getListRelativeFolderPath=function(){i.Validate.isNonemptyString(this._webPartCachePath,"this._webPartCachePath"),i.Validate.isNonemptyString(this._currentPageCacheFolderKey,"this._currentPageCacheFolderKey");var e=K.getUrlLastSegment(this._webPartCachePath);return v.Uri.concatenate(e,this._currentPageCacheFolderKey)},t.prototype._createLocalItems=function(e){var t=this;e.forEach(function(e){if(!t._cacheItemsMap.has(e.CacheKey)){var n={webPartInstanceId:e.CacheKey,result:e.CacheValue,hash:e.CacheValueHash,id:e.ListItemId,modified:e.ModifiedTimeUtc,cacheVersion:e.CacheVersion};t._cacheItemsMap.set(e.CacheKey,n)}}),this._logCacheItemSize()},t.prototype._updateLocalItems=function(e){var t=this;e.forEach(function(e){if(t._cacheItemsMap.has(e.CacheKey)){var n=t._getCachedItem(e.CacheKey);n.result=e.CacheValue,n.hash=e.CacheValueHash,n.cacheVersion=e.CacheVersion}}),this._logCacheItemSize()},t.prototype._logCacheItemSize=function(){r._TraceLogger.logVerbose(t._logSource,"_cacheItemsMap Size: ".concat(this._cacheItemsMap.size,"."))},t.prototype._captureCacheKeyUsageTelemetry=function(e,t){new r._QosMonitor("MySiteWebPartCacheConfigHash").writeSuccess({alias:e,id:this._currentPageCacheFolderKey,instanceId:t})},t.prototype._logCacheStart=function(e,n,a){r._TraceLogger.logVerbose(t._logSource,"WebPart: ".concat(e,", Page: ").concat(this._currentPageCacheFolderKey,", Environment: ").concat(i.Environment.type,".")),r._EngagementLogger.logEvent(a),f._PerformanceLogger.markComponent(n,"CacheStart")},t.prototype._logConfigMismatch=function(e,n,a){n?a||(r._TraceLogger.logVerbose(t._logSource,"Cache config mismatch for ".concat(e)),f._PerformanceLogger.markComponent(e,"CacheMissConfigMismatch")):(r._TraceLogger.logVerbose(t._logSource,"Cached data not found for ".concat(e)),f._PerformanceLogger.markComponent(e,"CachedWebPartNotFound"))},t.prototype._logCacheHit=function(e){this._setLKGOnTimeState(!0,"true"),r._TraceLogger.logVerbose(t._logSource,"CacheHit: Returning cached item for ".concat(e,".")),f._PerformanceLogger.markComponent(e,"CacheHit")},t.prototype._logCacheExpired=function(e){this._setLKGOnTimeState(!0,"stale"),r._TraceLogger.logVerbose(t._logSource,"Requested cached item for ".concat(e," exists but is expired.")),f._PerformanceLogger.markComponent(e,"CacheExpired"),this._logCacheMiss(e)},t.prototype._logCacheMiss=function(e){this._setLKGOnTimeState(!1,"false"),r._TraceLogger.logVerbose(t._logSource,"Cache Miss for ".concat(e)),r._EngagementLogger.logEvent("MySiteWebPartCacheDataProvider.CacheMiss"),f._PerformanceLogger.markComponent(e,"CacheMiss")},t.prototype._logLateFlush=function(e){this._setLKGOnTimeState(!1,"false"),r._TraceLogger.logVerbose(t._logSource,"Racing between late flush and data fetch for ".concat(e)),f._PerformanceLogger.markComponent(e,"LateFlush")},t.prototype._setLKGOnTimeState=function(e,t){void 0===this._cacheOnTime&&(this._cacheOnTime=e,f._PerformanceLogger.setPerformanceProperty("lkgOnTime",t))},t.prototype._logSmartRaceError=function(e){r._TraceLogger.logError(t._logSource,e)},t.prototype._isMySiteCacheSmartRaceRefactorEnabled=function(){return i._SPFlight.isEnabled(1549)},t._itemsToDeferUpdate=new Map,t._logSource=r._LogSource.create("MySiteWebPartCacheDataProvider"),t}(),X=function(){function e(e){this._isDisposed=!1,this._mySiteWebPartCacheDataProvider=new J(e),this._serviceScope=e,i._SPEventManager.instance.registerEvent("resetLegacyCacheManager",this,this.initializeCacheProvider)}return e._calculateHash=function(e){return K.generateHash(JSON.stringify(e))},Object.defineProperty(e.prototype,"instanceId",{get:function(){return this._instanceId},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"componentId",{get:function(){return"96f08fe4-4e36-4fc2-8d13-f19ac082aedd"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isDisposed",{get:function(){return this._isDisposed},enumerable:!1,configurable:!0}),e.prototype.dispose=function(){this._isDisposed||(this._isDisposed=!0)},e.prototype.getCacheItemVersion=function(e){return this._mySiteWebPartCacheDataProvider.getCacheItemVersion(e)},e.prototype.initializeCacheProvider=function(e){var t,n;e!==(null===(n=null===(t=window._spWebPartData)||void 0===t?void 0:t.Properties)||void 0===n?void 0:n.PageCacheFolderKey)&&(window._spWebPartData=void 0,window._spWebPartDataLoaded=void 0),this._mySiteWebPartCacheDataProvider=new J(this._serviceScope),r._EngagementLogger.logEvent("MySiteWebPartCacheDataManager.InPageNavTriggered")},e.prototype.requestWebPartCacheData_deprecated=function(e){return this._mySiteWebPartCacheDataProvider.getWebPartData(e.requestData,e.dataUpdated,e.config,e.webPartInstanceId,e.webPartAlias,e.rerender,e.secondsToInvalidate,e.webPartTag)},e.prototype.requestWebPartCacheData=function(e){var t=this,n=new r._QosMonitor("MySiteWebPartCacheDataManager.requestWebPartCacheData");return this._mySiteWebPartCacheDataProvider.getCacheData(e).then(function(a){var i=a.cacheResponseType===l.CacheResponseType.CachedData?"Completed":"Miss",r=a.cacheResponseType===l.CacheResponseType.CachedData?"Waiting":"Completed";return n.writeSuccess(t._mySiteWebPartCacheDataProvider.getWebPartIdLogObject(e.webPartAlias,e.webPartInstanceId,i,r)),a}).catch(function(a){return a.serverResponseAsync.catch(function(a){n.writeUnexpectedFailure("FailedToRetrieveCacheAndServerData",a,t._mySiteWebPartCacheDataProvider.getWebPartIdLogObject(e.webPartAlias,e.webPartInstanceId,"Failed","Failed"))}),a})},e.prototype.getCachedData=function(t,n){return i.Validate.isNotNullOrUndefined(t,"context"),i.Validate.isNotNullOrUndefined(n,"configuration"),this._mySiteWebPartCacheDataProvider._internalAdvancedGetCachedData(t.instanceId,e._calculateHash(n))},e.prototype.setCachedData=function(t,n,a){i.Validate.isNotNullOrUndefined(t,"context"),i.Validate.isNotNullOrUndefined(n,"configuration"),this._mySiteWebPartCacheDataProvider._internalAdvancedSetCacheData(t,e._calculateHash(n),a&&JSON.stringify(a))},e.serviceKey=i.ServiceKey.create("sp-component-utilities:MySiteWebPartCacheManager",e),e}();const Z=function(){function e(){}return e.isMySiteCacheSmartRaceRefactorEnabled=function(){return i._SPFlight.isEnabled(1549)},e.isIDBTieredModelEnabled=function(){return 1===f._SPPerfExperiment.getVariantAndTrackExperiment(f._PerformanceExperiment.WEXUseIndexedDBTieredCachingExp)||i._SPFlight.isEnabled(1693)},e}();var $=U(134),ee=U(362);function te(){return i._SPKillSwitch.isActivated("172fdbb3-0127-4d1a-8518-d03c566c0629")}function ne(){return i._SPKillSwitch.isActivated("82fc8496-5825-4d7e-bd84-1b18c82894d4")}var ae=function(){function t(){}return t.getCustomerPromiseBaseEndSchema=function(n){var a,i,r,o,s,c,d,l,u,f=!!n.customerPromisePrefetchStatus&&!n.customerPromisePrefetchStatus.hit,p=!!n.customerPromiseCacheDataRenderStatus&&!n.customerPromiseCacheDataRenderStatus.hit,m=!!n.customerPromiseCacheDataRenderStatus&&Boolean(n.customerPromiseCacheDataRenderStatus.noFreshRender),_=!!n.customerPromiseFreshDataStatus&&!n.customerPromiseFreshDataStatus.apiSuccess;u=ne()?!!n.customerPromiseImagesRenderStatus&&n.customerPromiseImagesRenderStatus.images.length>n.customerPromiseImagesRenderStatus.successCount+n.customerPromiseImagesRenderStatus.delayedImages.length:!!n.customerPromiseImagesRenderStatus&&Boolean(n.customerPromiseImagesRenderStatus.error||n.customerPromiseImagesRenderStatus.images.length>n.customerPromiseImagesRenderStatus.successCount+n.customerPromiseImagesRenderStatus.delayedImages.length);var h=!!n.customerPromiseCustomDependency&&!n.customerPromiseCustomDependency.success,b={resultType:f&&_||(m?p:p&&_)||_||u||h?v.ResultTypeEnum.Failure:v.ResultTypeEnum.Success};if(n.customerPromiseFreshDataStatus&&(b.extraData=(0,e.__assign)((0,e.__assign)({},b.extraData),{dataSource:n.customerPromiseFreshDataStatus.dataSource})),u){if(!ne()){var g=this._getSingleError(b.resultType,(null===(a=n.customerPromiseImagesRenderStatus.error)||void 0===a?void 0:a.errorCode)||"Images Render Incomplete");return b.errorCode=null==g?void 0:g.errorCode,b.extraData=(0,e.__assign)((0,e.__assign)((0,e.__assign)({},b.extraData),{imageRenderErrorMessage:n.customerPromiseImagesRenderStatus.error.message,imageRenderStatus:t._generateImageRenderStatus(n.customerPromiseImagesRenderStatus)}),this._getSingleVeto(b.resultType,"imageRenderError")),b}var y=t._getImagesErrorCount(n.customerPromiseImagesRenderStatus);g=this._getSingleError(b.resultType,y),b.errorCode=null==g?void 0:g.errorCode,b.extraData=(0,e.__assign)((0,e.__assign)((0,e.__assign)({},b.extraData),{imageRenderUnexpectedErrorCount:y}),this._getSingleVeto(b.resultType,"imageRenderUnexpectedErrorCount"))}if(f){var S=null===(i=n.customerPromisePrefetchStatus)||void 0===i?void 0:i.failedReason;if(g=this._getSingleError(b.resultType,S),b.errorCode=null==g?void 0:g.errorCode,b.extraData=(0,e.__assign)((0,e.__assign)((0,e.__assign)({},b.extraData),{flushedError:S}),this._getSingleVeto(b.resultType,"flushError")),!ne())return b}else n.customerPromisePrefetchStatus&&(b.extraData=(0,e.__assign)((0,e.__assign)({},b.extraData),{flushOnTime:null===(r=n.customerPromisePrefetchStatus)||void 0===r?void 0:r.flushOnTime}));if(_&&(null===(o=n.customerPromiseCacheDataRenderStatus)||void 0===o?void 0:o.emptyData)&&(b.extraData=(0,e.__assign)((0,e.__assign)({},b.extraData),{cacheError:"CacheEmpty"})),p){var D=null===(s=n.customerPromiseCacheDataRenderStatus)||void 0===s?void 0:s.failedReason;g=this._getSingleError(b.resultType,D),b.errorCode=null==g?void 0:g.errorCode,b.extraData=(0,e.__assign)((0,e.__assign)((0,e.__assign)({},b.extraData),{cacheError:D}),this._getSingleVeto(b.resultType,"cacheError"))}if(_){var I=null===(c=n.customerPromiseFreshDataStatus)||void 0===c?void 0:c.failedReason;g=this._getSingleError(b.resultType,I),b.errorCode=null==g?void 0:g.errorCode,b.extraData=(0,e.__assign)((0,e.__assign)((0,e.__assign)({},b.extraData),{freshError:I}),this._getSingleVeto(b.resultType,"freshError"))}if(h){var x=null===(d=n.customerPromiseCustomDependency)||void 0===d?void 0:d.failedReason,C=(null===(l=n.customerPromiseCustomDependency)||void 0===l?void 0:l.veto)||"CustomDependency";g=this._getSingleError(b.resultType,x),b.errorCode=null==g?void 0:g.errorCode,b.extraData=(0,e.__assign)((0,e.__assign)((0,e.__assign)({},b.extraData),{customDependencyError:h,customDependencyErrorDetails:x}),this._getSingleVeto(b.resultType,C))}return b},t.checkRequirementComplete=function(e,n,a,i,r,o,s){var c,d=e.hasCacheDataRender,l=e.hasFlushedDataRender,u=e.hasFreshDataRender,f=e.hasImages,p=e.hasCustomDependency,m=!d&&!l&&!u,_=!!d&&Boolean(n)&&Boolean(null==n?void 0:n.noFreshRender),h=!!l&&Boolean(null==a?void 0:a.hit),b=!!u&&Boolean(i),g=t._hasContentFetchFailed(s,n,a,i),v=t._hasData(s,n,a,i),y=!!r&&r.renderType===s,S=!!r&&r.images.length===r.count+r.delayedImages.length;c=ne()?!(f&&v&&!g)||!!y&&S:!(f&&v&&!g)||!!y&&(!!r.error||S);var D=!p||Boolean(o);return!!((m||h||_||b)&&c&&D)},t.updateCustomerPromiseCachedDataRenderStatus=function(e,t){var n=t.isCacheDataEmpty,a=t.error;return void 0===a?(e.hit=!0,e.emptyData=Boolean(n)):(e.hit=!1,e.failedReason=a),e},t.updateCustomerPromiseFlushedDataRenderStatus=function(e,t){var n=t.isFlushedDataEmpty,a=t.isFlushOnTime,i=t.error;return void 0===i?(e.hit=!0,e.emptyData=Boolean(n),e.flushOnTime=a):(e.hit=!1,e.failedReason=i),e},t.updateCustomerPromiseFreshDataRenderStatus=function(e,t){var n=t.dataProvider,a=t.isServerResultEmpty,i=t.error;return e.dataSource=n,void 0===i?(e.apiSuccess=!0,e.emptyData=Boolean(a)):(e.apiSuccess=!1,e.failedReason=i),e},t.updateCustomerPromiseCustomDependencyStatus=function(e,t){var n=t.success,a=t.failedReason,r=t.veto;return e.success=n,n||(e.failedReason=a,i._SPKillSwitch.isActivated("6f174085-080f-401b-8cad-7dacbfed1e4a")||(e.veto=r)),e},t.updateCustomerPromiseImagesRenderStatus=function(e,n,a,i,r){if(t._isImageFromLatestRender(e.renderType,a)&&t._isImageInitialized(e.images,n)){if("Delayed"===i)return e.delayedImages.push(n),e;e.delayedImages.indexOf(n)>=0&&(e.delayedImages=e.delayedImages.filter(function(e){return e!==n})),"Success"===i&&(e.successCount=e.successCount+1),e.count=e.count+1,ne()||"Failure"!==i||(e.error=r,r||(e.error={errorCode:"Unknown Failure"}))}return e},t.logNoFreshRenderAfterCacheRender=function(e){return e.noFreshRender=!0,e},t.logCustomerPromise=function(e,t){e.end(t)},t._getSingleError=function(e,t){if(!te()&&e!==v.ResultTypeEnum.Success)return{errorCode:t.toString()}},t._getSingleVeto=function(e,t){if(!te()&&e!==v.ResultTypeEnum.Success)return{Veto:t}},t._generateImageRenderStatus=function(e){return"Render Type ".concat(e.renderType,". Total : ").concat(e.images.length,". Successful : ").concat(e.successCount,". Delayed : ").concat(e.delayedImages.length)},t._isImageFromLatestRender=function(e,t){return e===t},t._isImageInitialized=function(e,t){return e.indexOf(t)>=0},t._getImagesErrorCount=function(e){return e.images.length-(e.successCount+e.delayedImages.length)},t._hasContentFetchFailed=function(e,t,n,a){switch(e){case"CACHE":return!(null==t?void 0:t.hit);case"FLUSH":return!(null==n?void 0:n.hit);case"FRESH":return!(null==a?void 0:a.apiSuccess);case"STATIC":return!1}},t._hasData=function(e,t,n,a){switch(e){case"CACHE":return Boolean(t)&&!(null==t?void 0:t.emptyData);case"FLUSH":return Boolean(n)&&!(null==n?void 0:n.emptyData);case"FRESH":return Boolean(a)&&!(null==a?void 0:a.emptyData);case"STATIC":return!0}},t}();const ie=function(){function t(){this._customerPromiseRules={},this._customerPromiseTimeout=4e3,this._isCustomerPromiseLogged=!1,this._latestRender="STATIC"}return t.prototype.initializeCustomerPromise=function(e,t,n,a){var i={scenario:e,extraData:{pageType:n.pageType||"L1",Pillar:null==a?void 0:a.pillar,Endpoint:null==a?void 0:a.endpoint,Product:null==a?void 0:a.product}};this._customerPromise=new ee.CustomerPromise(i),this._customerPromiseTimeout=t,this._customerPromiseRules=n},t.prototype.initializeCustomerPromiseImages=function(e,t){this._imagesRenderStatus={images:t,delayedImages:[],renderType:e,count:0,successCount:0},0===t.length&&this.validateAndLogCustomerPromise()},t.prototype.updateCustomerPromiseCachedDataRenderStatus=function(e){this._cachedDataRenderStatus={},ae.updateCustomerPromiseCachedDataRenderStatus(this._cachedDataRenderStatus,e),this._latestRender="CACHE",this.validateAndLogCustomerPromise()},t.prototype.logNoFreshRenderAfterCacheRender=function(){this._cachedDataRenderStatus&&(ae.logNoFreshRenderAfterCacheRender(this._cachedDataRenderStatus),this.validateAndLogCustomerPromise())},t.prototype.updateCustomerPromiseFlushedDataRenderStatus=function(e){this._flushedDataRenderStatus={},ae.updateCustomerPromiseFlushedDataRenderStatus(this._flushedDataRenderStatus,e),this._latestRender="FLUSH",this.validateAndLogCustomerPromise()},t.prototype.updateCustomerPromiseFreshDataRenderStatus=function(e){this._freshDataRenderStatus={},ae.updateCustomerPromiseFreshDataRenderStatus(this._freshDataRenderStatus,e),this._latestRender="FRESH",this.validateAndLogCustomerPromise()},t.prototype.updateCustomerPromiseImageRenderStatus=function(e){var t=e.image,n=e.renderType,a=e.status,i=e.error;this._imagesRenderStatus&&(this._imagesRenderStatus=ae.updateCustomerPromiseImagesRenderStatus(this._imagesRenderStatus,t,n,a,i)),this.validateAndLogCustomerPromise()},t.prototype.updateCustomerPromiseCustomDependencyStatus=function(e){this._customDependencyStatus={},ae.updateCustomerPromiseCustomDependencyStatus(this._customDependencyStatus,e),this.validateAndLogCustomerPromise()},t.prototype.validateAndLogCustomerPromise=function(t){if(!this._isCustomerPromiseLogged&&(t||ae.checkRequirementComplete(this._customerPromiseRules,this._cachedDataRenderStatus,this._flushedDataRenderStatus,this._freshDataRenderStatus,this._imagesRenderStatus,this._customDependencyStatus,this._latestRender))){var n=this._getEndSchema();t&&(n.extraData=(0,e.__assign)((0,e.__assign)({},n.extraData),{timeout:!0})),this._logCustomerPromise(n),this._isCustomerPromiseLogged=!0}},t.prototype.logCustomerPromiseOnUnload=function(){var t=this._getEndSchema();i._SPKillSwitch.isActivated("3aa19c44-3639-45d0-acb3-62e47009f5a2")||this._isCustomerPromiseLogged||(t.errorCode=void 0,t.resultType=ee.ResultTypeEnum.Success,t.extraData=(0,e.__assign)((0,e.__assign)({},t.extraData),{Veto:void 0,incomplete:!0}),this._logCustomerPromise(t),this._isCustomerPromiseLogged=!0)},t.prototype._getEndSchema=function(){return ae.getCustomerPromiseBaseEndSchema({customerPromiseFreshDataStatus:this._freshDataRenderStatus,customerPromiseCacheDataRenderStatus:this._cachedDataRenderStatus,customerPromisePrefetchStatus:this._flushedDataRenderStatus,customerPromiseImagesRenderStatus:this._imagesRenderStatus,customerPromiseCustomDependency:this._customDependencyStatus})},t.prototype._logCustomerPromise=function(e){this._customerPromise&&ae.logCustomerPromise(this._customerPromise,e)},t}(),re=function(t){function n(){var e=t.call(this)||this;return e._baseCustomerPromiseTimer=void 0,e._baseCustomerPromise=new ie,e}return(0,e.__extends)(n,t),n.prototype.initializeCustomerPromise=function(e,t,n,a){this._baseCustomerPromise.initializeCustomerPromise(e,t,n,a)},n.prototype.initializeCustomerPromiseImages=function(e,t){this._baseCustomerPromise.initializeCustomerPromiseImages(e,t)},n.prototype.updateCustomerPromiseCachedDataRenderStatus=function(e){this._baseCustomerPromise.updateCustomerPromiseCachedDataRenderStatus(e)},n.prototype.updateCustomerPromiseFlushedDataRenderStatus=function(e){this._baseCustomerPromise.updateCustomerPromiseFlushedDataRenderStatus(e)},n.prototype.updateCustomerPromiseFreshDataRenderStatus=function(e){this._baseCustomerPromise.updateCustomerPromiseFreshDataRenderStatus(e)},n.prototype.updateCustomerPromiseImageRenderStatus=function(e){this._baseCustomerPromise.updateCustomerPromiseImageRenderStatus(e)},n.prototype.updateCustomerPromiseCustomDependencyStatus=function(e){this._baseCustomerPromise.updateCustomerPromiseCustomDependencyStatus(e)},n.prototype.logNoFreshRenderAfterCacheRender=function(){this._baseCustomerPromise.logNoFreshRenderAfterCacheRender()},n.prototype.logPostRenderCustomerPromise=function(){var e=this;window.onbeforeunload=function(){e._baseCustomerPromise.logCustomerPromiseOnUnload()},clearTimeout(this._baseCustomerPromiseTimer),this._baseCustomerPromiseTimer=window.setTimeout(function(){e._baseCustomerPromise.validateAndLogCustomerPromise(!0)},this._baseCustomerPromise._customerPromiseTimeout)},n.prototype.onDispose=function(){this._baseCustomerPromise.logCustomerPromiseOnUnload()},n}($.BaseClientSideWebPart);var oe;!function(e){e[e.BadRequest=400]="BadRequest",e[e.Forbidden=403]="Forbidden",e[e.NotFound=404]="NotFound",e[e.NotAcceptable=406]="NotAcceptable",e[e.RequestTimeout=408]="RequestTimeout",e[e.Conflict=409]="Conflict",e[e.RequestEntityTooLarge=413]="RequestEntityTooLarge",e[e.UnprocessableEntity=422]="UnprocessableEntity",e[e.TooManyRequest=429]="TooManyRequest",e[e.ServerError=500]="ServerError",e[e.NotImplemented=501]="NotImplemented",e[e.BadGateway=502]="BadGateway",e[e.ServiceUnavailable=503]="ServiceUnavailable",e[e.Timeout=504]="Timeout",e.MiscellaneousError="MiscellaneousError"}(oe||(oe={}));var se={Append:0,Replace:1,Compare:2},ce="bcwpDataProvider",de="bcwpRequestData",le=function(s){function c(){var e=s.call(this)||this;return e.rendersRequested=0,e.rendersCompleted=0,e.failedRendersCompleted=0,e._getEmphasisTheme=function(){var t=e.context.serviceScope.consume(B.ThemeProvider.serviceKey);e._emphasisTheme=t.tryGetTheme(),t.themeChangedEvent.add(e,e._handleThemeChangedEvent)},e._handleThemeChangedEvent=function(t){e._emphasisTheme=t.theme,e.render()},e._getPrefetchedDataAsync=function(t,n){var a="bcwpGetPrefetchedDataAsync",i=c._getContextLogSource(e.context);return r._TraceLogger.logVerbose(i,"".concat(a,".start")),e.getPrefetchedDataAsync(t,n).then(function(t){return r._TraceLogger.logVerbose(i,"".concat(a,".end")),f._PerformanceLogger.markComponent(e.context.webPartTag,"prefetchedData"),Promise.resolve(t)}).catch(function(e){return r._TraceLogger.logVerbose(i,"".concat(a,".end")),Promise.reject(e)})},e._disableDataRequest=!1,e._isSelectedLayoutLogged=!1,e}return(0,e.__extends)(c,s),c._isOAuthUtilityError=function(e){var t=Object.getPrototypeOf(e);return t.constructor&&"OAuthUtilityError"===t.constructor.name},c._getContextLogSource=function(e){var t=e&&e.webPartTag;return r._LogSource.create(t||"BaseCollectionWebPart")},Object.defineProperty(c.prototype,"component",{get:function(){return this._component},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"response",{get:function(){return this._response},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"activeLayoutInfo",{get:function(){return this._activeLayoutInfo},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"activeDataProviderInfo",{get:function(){return this._activeDataProviderInfo},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"isContributor",{get:function(){var e=this.context.pageContext.web.permissions;return!!e&&e.hasPermission(j.SPPermission.addListItems)},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"isRenderAsync",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"sectionBackgroundTheme",{get:function(){return this._emphasisTheme},enumerable:!1,configurable:!0}),c.prototype.updateActiveLayoutProp=function(e,t){this._activeLayoutInfo.properties[e]=t},c.prototype.onInit=function(){var e=this;this._response=[],this._options=this.options;var t=new f._QosMonitor("".concat(this._options.qosPrefix,"Mount"));if(this._shouldUseLegacyMySiteWebPartCache()||i._SPKillSwitch.isActivated("f186df9f-68c1-472c-94fe-d68b47deaa27")||(f._PerformanceLogger.trackWebpartFlight(this.context.webPartTag,f._PerformanceFlight.WEXUseIndexedDBTieredCaching),f._PerformanceLogger.trackWebpartExperiment(this.context.webPartTag,f._PerformanceExperiment.WEXUseIndexedDBTieredCachingExp),f._PerformanceLogger.trackWebpartExperiment(this.context.webPartTag,f._PerformanceExperiment.WEXTieredCachingLateFlushExp)),this._onComponentMounted=this._onComponentMounted.bind(this),this.setDefaultProperties(this.properties),this._layoutInfos=this.layouts,this._setSelectedLayout(),this._setSelectedDataProvider(),this._getDisplayFieldMaps(),this._activeLayoutInfo.hasInitialLoadingState)this.render();else if(!this._activeLayoutInfo&&!i._SPKillSwitch.isActivated("735b8a3b-23cb-4e4c-96ab-443c97ba3817")){var n=new Error(R.Py);if(this._handleRenderLayoutError(n),!this._isCommonCustomerPromiseEnabled()){var a={alias:this._options.qosPrefix};t.writeUnexpectedFailure("FailedNoLayout",n,a)}this.options.isRenderAsync||this.renderCompleted()}return new Promise(function(n,a){var i=e.context.serviceScope;i.whenFinished(function(){e.pageContext=i.consume(j.PageContext.serviceKey),e._shouldUseLegacyMySiteWebPartCache()&&(e._mySiteCacheWebPartManager=i.consume(X.serviceKey)),e._setPageContextVariables(),e._async=new o.Async(e);var a,s=void 0===e._options.delayBeforeNoResultsMessage?500:e._options.delayBeforeNoResultsMessage;e.delayedGetDataAndRender=e._async.debounce(e.refreshData,s);var d,u=e.getPrefetchedData(e._activeDataProviderInfo.id,e._activeLayoutInfo.id),p=e.context,m=p.instanceId,_=p.manifest,h=p.webPartTag;if(void 0!==u)d="bcwpPrefetchedData",f._PerformanceLogger.markComponent(h,"prefetchedData"),f._PerformanceLogger.markComponent(h,"CacheHit"),a=Promise.resolve(u);else if(e._shouldUseLegacyMySiteWebPartCache()){d="bcwpCachedDataRequest";var b=e.dataCacheConfiguration,g={requestData:e.requestData.bind(e),dataUpdated:e.setResponseAndRender.bind(e),webPartInstanceId:m,webPartAlias:_.alias,secondsToInvalidate:void 0};if(Z.isMySiteCacheSmartRaceRefactorEnabled()){var v="BaseCollection_".concat(h);f._PerformanceLogger.markComponent(v,"LKGRequest");var y=g;y.serializedConfiguration=JSON.stringify(b),a=e._mySiteCacheWebPartManager.requestWebPartCacheData(y).then(function(t){return e._isResponseFromCache=t.cacheResponseType===l.CacheResponseType.CachedData,(t.cacheResponseAsync||t.serverResponseAsync).then(function(t){var n=new r._LogEntry("MySiteCacheDataMetrics","CacheDataSize",r._LogType.Event,{dataSizeInKB:t?"".concat(JSON.stringify(t).length/1024):"0",dataProvider:e._activeDataProviderInfo.id,isCacheHit:"".concat(e._isResponseFromCache),numberOfItems:t?"".concat(t.length):"0"});return r._EngagementLogger.logEventWithLogEntry(n),t})}).then(function(e){return f._PerformanceLogger.markComponent(v,"DataReturned"),e})}else{var S=g;S.config=b,S.webPartTag=h,a=e._mySiteCacheWebPartManager.requestWebPartCacheData_deprecated(S)}}else d="bcwpRacePrefetchedDataAsync",e._shouldUseLegacyMySiteWebPartCache()&&(f._PerformanceLogger.markComponent(h,"CacheMiss"),f._PerformanceLogger.markComponent(h,"LateFlush")),a=Promise.race([e._getPrefetchedDataAsync(e._activeDataProviderInfo.id,e._activeLayoutInfo.id),e.requestData()]);var D=c._getContextLogSource(e.context);d&&r._TraceLogger.logVerbose(D,"".concat(d,".start")),a.then(function(a){e._shouldUseLegacyMySiteWebPartCache()&&"2.0"===e._mySiteCacheWebPartManager.getCacheItemVersion(e.context.instanceId)&&(a=e.postProcessTieredCachedData(a)),e._response=a,d&&r._TraceLogger.logVerbose(D,"".concat(d,".end")),e.renderedOnce||t.writeSuccess(),n()}).catch(function(a){e._handleRequestDataError(a),d&&r._TraceLogger.logError(D,a,"".concat(d,".end")),t.writeUnexpectedFailure("FailedInitialDataRequest",a),n()})})}).then(function(){return e._getEmphasisTheme()})},c.prototype.postProcessTieredCachedData=function(e){return e},c.prototype.setLayoutById=function(e){this.properties.layoutId=e,this._setSelectedLayout()},c.prototype.setLayoutByKey=function(e){for(var t=0,n=this._layoutInfos;t<n.length;t++){var a=n[t];if(a.option&&a.option.key===e){this.setLayoutById(a.id);break}}},c.prototype.getPrefetchedData=function(e,t){},c.prototype.getPrefetchedDataAsync=function(e,t){return new Promise(function(e,t){})},Object.defineProperty(c.prototype,"dataProvider",{get:function(){this._dataProviderPromises||(this._dataProviderPromises=new Map);var e=this._dataProviderPromises.get(this._activeDataProviderInfo.id);return e||(e=this._activeDataProviderInfo.loadDataProvider(this._activeDataProviderInfo.options||{serviceScope:this.context.serviceScope,qosPrefix:this._options.qosPrefix}),this._dataProviderPromises.set(this.activeDataProviderInfo.id,e)),e},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"usingEmptyStateRows",{get:function(){return this._usingEmptyStateRows},enumerable:!1,configurable:!0}),c.prototype.onAfterPropertiesUpdatedExternally=function(t){var n=this,a=t.title,i=t.layoutId,r=t.hideWebPartWhenEmpty,o=t.addToPageScreenReaderLabel,s=(0,e.__rest)(t,["title","layoutId","hideWebPartWhenEmpty","addToPageScreenReaderLabel"]),c=this.properties,d=c.title,l=c.layoutId,u=c.hideWebPartWhenEmpty,p=c.addToPageScreenReaderLabel,m=(0,e.__rest)(c,["title","layoutId","hideWebPartWhenEmpty","addToPageScreenReaderLabel"]),_=h.isEqual(s,m)&&(a!==d||i!==l||r!==u||o!==p);if(i!==l&&this._setSelectedLayout(),_)this.render();else if(t.dataProviderId!==this.properties.dataProviderId&&this.setDataProviderById(this.properties.dataProviderId),!h.isEqual(s,m)){var b=new f._QosMonitor("BaseCollectionWebPart.onAfterPropertiesUpdatedExternally");this.refreshData().then(function(e){var t={alias:"".concat(n.context.manifest.alias)};e?b.writeSuccess(t):b.writeUnexpectedFailure("Failed to refreshData",void 0,t)})}},c.prototype.setDataProviderById=function(e){this.properties.dataProviderId=e,this._setSelectedDataProvider()},c.prototype.setDataProviderByKey=function(e){for(var t=0,n=this.dataProviders;t<n.length;t++){var a=n[t];if(a.option&&a.option.key===e){this.setDataProviderById(a.id);break}}},c.prototype.getDisplayFieldMap=function(e,t){},Object.defineProperty(c.prototype,"propertyPaneLayoutOptions",{get:function(){return this._layoutInfos.map(function(e){var t=e.option;return{ariaLabel:t.ariaLabel,imageSize:{width:32,height:32},imageSrc:t.imageSrc,key:t.key,text:t.title,themableSvg:t.themableSvg,iconProps:t.iconProps,disabled:i._SPKillSwitch.isActivated("9a71a52c-3423-4671-8391-77286dc0cf18")?void 0:t.disabled}})},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"dataCacheConfiguration",{get:function(){return{}},enumerable:!1,configurable:!0}),c.prototype.refreshData=function(e,t,n){var a=this;return void 0===t&&(t=se.Replace),void 0===n&&(n=!0),this.requestData(e).then(function(e){var i;switch(t){case se.Append:i=a._response=a._response.concat(e);break;case se.Compare:i=e;break;case se.Replace:default:i=a._response=e}return n&&a.render(),i}).catch(function(e){a._handleRequestDataError(e)})},c.prototype.transposeRow=function(e,t,n,a){return n},c.prototype.transposeItems=function(e,t,n){return n},c.prototype.overlayRender=function(){return null},c.prototype.render=function(){var n=this,r=new f._QosMonitor("".concat(this._options.qosPrefix,"Render")),s={alias:this._options.qosPrefix};if(!this._activeLayoutInfo){var c=new Error(R.Py);return this._handleRenderLayoutError(c),this._isCommonCustomerPromiseEnabled()||r.writeUnexpectedFailure("FailedNoLayout",c,s),void this.renderCompleted()}s.layout=this._activeLayoutInfo.id,this.rendersRequested++,this.onPreRender(this._activeLayoutInfo.id,this._activeDataProviderInfo.id,this._response).then(function(c){var d,l,u,p;c&&(n._options=(0,e.__assign)((0,e.__assign)({},n._options),c));var m=n.context.webPartTag;f._PerformanceLogger.markComponent(m,"".concat(f._PerformanceDataDimensions.Layout).concat(n.activeLayoutInfo.id));var _=(0,e.__assign)((0,e.__assign)((0,e.__assign)({},n._options),n.properties),(null===(d=n._activeLayoutInfo)||void 0===d?void 0:d.properties)||{});if((0,x.eB)()&&void 0!==n.properties.isTitleEnabled&&(_.showTitle=n.properties.isTitleEnabled),_.webPartTag=m,_.emphasisTheme=n._emphasisTheme,_.emphasisTheme||(_.emphasisTheme=(0,o.getTheme)()),Z.isMySiteCacheSmartRaceRefactorEnabled()&&(_.isRenderedFromCacheData=n._isResponseFromCache),_.isInTeamsContext=!!n.context.sdks.microsoftTeams,_.hasInitialLoadingState=null===(l=n._activeLayoutInfo)||void 0===l?void 0:l.hasInitialLoadingState,_.displayMode=n.displayMode,_.errorCallback=n._handleRenderLayoutError.bind(n),_.renderedOnce=n.renderedOnce,_.defaultTitle=n.defaultTitle,_.layoutInfo=n._activeLayoutInfo,_.width=n.width,_.registerEvent=function(e,t){return i._SPEventManager.instance.registerEvent(e,n,t)},_.unregisterEvent=function(e,t){return i._SPEventManager.instance.unregisterEvent(e,n,t)},n._activeLayoutInfo.displayFieldMaps&&(_.displayFieldMap=n._activeLayoutInfo.displayFieldMaps[n._activeDataProviderInfo.id]),_.items=void 0,_.onComponentMounted=n._onComponentMounted,_.onTitleChange=function(e){return n.properties.title=e},_.changeVisibility=function(e){return n.isVisible=e},n._activeLayoutInfo.displayFieldMaps&&n._activeDataProviderInfo){var h=n._activeLayoutInfo.displayFieldMaps[n._activeDataProviderInfo.id];h&&(_.displayFieldMap=h,((0,C.nt)()?n._response:null===(u=n._response)||void 0===u?void 0:u.length)?_.items=h.transpose(n._response,function(e){return n.transposeRow(n._activeLayoutInfo.id,n._activeDataProviderInfo.id,e,n._activeDataProviderInfo.options)}):_.items=[])}_.items||(((0,C.nt)()?n._response:null===(p=n._response)||void 0===p?void 0:p.length)?_.items=n._response.map(function(e){return n.transposeRow(n._activeLayoutInfo.id,n._activeDataProviderInfo.id,e,n._activeDataProviderInfo.options)}):_.items=[]),_.items=n.transposeItems(n._activeLayoutInfo.id,n._activeDataProviderInfo.id,_.items);try{var b=t.createElement(t.Fragment,null,t.createElement(N,(0,e.__assign)({},_)),!i._SPKillSwitch.isActivated("1389b1d0-5020-46c3-82bb-2b8d17445a30")&&n.overlayRender());n._component=a.render(b,n.domElement),n.renderedOnce||!n._component||n.renderedFromPersistedData||n._component.focusOnTitle(),n.onPostRender(n._activeLayoutInfo.id,n._activeDataProviderInfo.id,n._response).then(function(){n._isCommonCustomerPromiseEnabled()||r.writeSuccess(s)}).catch(function(e){n._isCommonCustomerPromiseEnabled()||r.writeUnexpectedFailure("FailedPostRender",e,s)})}catch(e){s.stack=e.stack,n._isCommonCustomerPromiseEnabled()||r.writeUnexpectedFailure("FailedRender",e,s),n.failedRendersCompleted++}n.rendersCompleted++,f._PerformanceLogger.saveTempData("".concat(m,".postRenderComplete"),f._PerformanceLogger.now())}).catch(function(e){n._handleRenderLayoutError(e),n._isCommonCustomerPromiseEnabled()||r.writeUnexpectedFailure("FailedPreRender",e,s),n.renderCompleted()})},c.prototype.onPreRender=function(e,t,n){return Promise.resolve(void 0)},c.prototype.onPostRender=function(e,t,n){return Promise.resolve(void 0)},c.prototype.onBeforeSerialize=function(){this.properties.title&&(this.properties.title=this.properties.title.trim())},c.prototype.onDispose=function(){n.unmountComponentAtNode(this.domElement),this.context.serviceScope.consume(B.ThemeProvider.serviceKey).themeChangedEvent.remove(this,this._handleThemeChangedEvent),s.prototype.onDispose.call(this)},Object.defineProperty(c.prototype,"propertiesMetadata",{get:function(){return{title:{isSearchablePlainText:!0},baseUrl:{isLink:!0},layoutComponentId:{isComponentDependency:!0}}},enumerable:!1,configurable:!0}),c.prototype.onDiscard=function(){var e=this;this.refreshData().catch(function(t){return r._TraceLogger.logError(c._getContextLogSource(e.context),t,"RefreshData")})},c.prototype.setDefaultProperties=function(e){},Object.defineProperty(c.prototype,"defaultTitle",{get:function(){return R.K9},enumerable:!1,configurable:!0}),c.prototype.getEmptyStateRows=function(e,t){},c.prototype.setResponse=function(e){this._response=e},c.prototype.setResponseAndRender=function(e){Z.isMySiteCacheSmartRaceRefactorEnabled()&&(this._isResponseFromCache=!1),this._response=e,this.render()},c.prototype.requestData=function(e){var t=this,n=this.context.webPartTag,a=c._getContextLogSource(this.context);return this._disableDataRequest||r._TraceLogger.logVerbose(a,"".concat(de,".start")),new Promise(function(i,o){if(t._disableDataRequest)return r._TraceLogger.logVerbose(a,"".concat(de,".end")),void i([]);if(t._activeDataProviderInfo){var s=new f._QosMonitor("".concat(t._options.qosPrefix,"RequestData"));r._TraceLogger.logVerbose(a,"".concat(ce,".start")),t.dataProvider.then(function(d){f._PerformanceLogger.markComponent(n,"".concat(f._PerformanceDataDimensions.DataProvider).concat(d.id)),r._TraceLogger.logVerbose(a,"".concat(ce,".end")),e=e||t.getRequest(t._activeDataProviderInfo.id,t._activeLayoutInfo.id),d.requestData(e).then(function(e){if(t._usingEmptyStateRows=!1,!e||0===e.length){t._usingEmptyStateRows=!0;var n=t.getEmptyStateRows(t._activeLayoutInfo.id,d.id);n&&(e=n)}i(e),r._TraceLogger.logVerbose(a,"".concat(de,".end")),t._isCommonCustomerPromiseEnabled()||s.writeSuccess()},function(e){t.context.statusRenderer.clearLoadingIndicator(t.domElement),r._TraceLogger.logVerbose(a,"".concat(de,".end")),t._isCommonCustomerPromiseEnabled()||s.writeUnexpectedFailure("FailedDataRequest",e),c._isOAuthUtilityError(e)&&t.canHandleOAuthError(e)?(t.render(),i(void 0)):o(e)})},function(e){f._PerformanceLogger.markComponent(n,"".concat(ce,".end")),t._isCommonCustomerPromiseEnabled()||s.writeUnexpectedFailure("FailedToLoadDataProvider",e),o(e)})}else r._TraceLogger.logVerbose(a,"".concat(de,".end")),o(new Error(R.vF))})},c.prototype.disableDataRequest=function(){this._disableDataRequest=!0},c.prototype.enableDataRequest=function(){this._disableDataRequest=!1},c.prototype.canHandleOAuthError=function(e){return!1},c.prototype.canHandleWebpartError=function(e){return!1},c.prototype.onPropertyPaneConfigurationComplete=function(){s.prototype.onPropertyPaneConfigurationComplete.call(this),this.properties.layoutId&&this._addBCWPSelectedLayoutEngagementLog(this.properties.layoutId)},c.prototype._handleRenderLayoutError=function(e){this.canHandleWebpartError(e)||s.prototype.renderError.call(this,e)},c.prototype._handleRequestDataError=function(e){c._isOAuthUtilityError(e)&&this.canHandleOAuthError(e)?this.render():this.renderError(e)},c.prototype._setPageContextVariables=function(){if(this._options.requirePageContextVariables){if(!this.pageContext)throw new Error(R._f);if(!this.pageContext.web)throw new Error(R.MA);if(this.pageContext.web.absoluteUrl){if(!this.pageContext.web.id)throw new Error(R.iP);if(this.properties.webId=this.pageContext.web.id.toString(),!this.pageContext.site)throw new Error(R.J4);if(!this.pageContext.site.id)throw new Error(R.Dw);this.properties.siteId=this.pageContext.site.id.toString(),this.properties.baseUrl=this.pageContext.web.absoluteUrl}else this.properties.webId="a50ff2b3-f789-4251-aad1-5909f23aed4f",this.properties.baseUrl="https://msft.spoppe.com/sites/wex"}},c.prototype._setSelectedLayout=function(){!this.properties.layoutId&&this._layoutInfos.length>0&&(this.properties.layoutId=this._layoutInfos[0].id,this.properties.layoutComponentId=this._layoutInfos[0].componentId);var e=this.properties.layoutId;if(e)for(var t=0,n=this._layoutInfos;t<n.length;t++){var a=n[t];if(a.id===e){this._activeLayoutInfo=a,this.properties.layoutComponentId=this._activeLayoutInfo.componentId;break}}},c.prototype._addBCWPSelectedLayoutEngagementLog=function(e){if(!this._isSelectedLayoutLogged){var t={component:"BaseWPSelectedLayout",extraData:{layoutId:e},feature:"WebPart",name:"".concat(this.context.manifest.alias,".BCWPSelectedLayout")};r._EngagementLogger.log(t),this._isSelectedLayoutLogged=!0}},c.prototype._setSelectedDataProvider=function(){if(!this.properties.dataProviderId&&this.dataProviders.length>0&&(this.properties.dataProviderId=this.dataProviders[0].id,this.properties.dataProviderComponentId=this.dataProviders[0].componentId),this.properties.dataProviderId)for(var e=0,t=this.dataProviders;e<t.length;e++){var n=t[e];if((null==n?void 0:n.id)===this.properties.dataProviderId){this._activeDataProviderInfo=n;break}}},c.prototype._getDisplayFieldMaps=function(){var e=this;this._layoutInfos.map(function(t){t.displayFieldMaps||(t.displayFieldMaps={}),e.dataProviders.map(function(n){n&&(t.displayFieldMaps[n.id]=e.getDisplayFieldMap(t.id,n.id))})})},c.prototype._onComponentMounted=function(){this.options.isRenderAsync||this.renderCompleted()},c.prototype._shouldUseLegacyMySiteWebPartCache=function(){return this._options.deprecated_canCacheResults&&!this._options.temporary_isTieredCacheImplementedInDataProvider},c.prototype._isCommonCustomerPromiseEnabled=function(){return this._options.isCustomerPromiseInitialized},c}(re),ue=function(){function t(){}return t.getCustomerPromiseBaseEndSchema=function(t,n,a){var i=!!a&&!a.hit,r=!!n&&!n.hit,o=!!t&&!t.apiSuccess,s={resultType:(r||i)&&o?v.ResultTypeEnum.Failure:v.ResultTypeEnum.Success,extraData:{}};return(i||r||o)&&(s.errorCode=""),i&&(s.errorCode+="PREFETCH_FAILED--",s.extraData=(0,e.__assign)((0,e.__assign)({},s.extraData),{prefetchError:"Prefetch Error: ".concat(a.failedReason)})),r&&(s.errorCode+="LKG_FAILED--",s.extraData=(0,e.__assign)((0,e.__assign)({},s.extraData),{lkgError:"LKG Error: ".concat(n.failedReason)})),o&&(s.errorCode+="API-FAILED",s.extraData=(0,e.__assign)((0,e.__assign)({},s.extraData),{apiError:"API Error: ".concat(t.apiFailedReason)})),s},t.updateCustomerPromiseStatus=function(e,t,n){return t&&(e.didRenderFromServer=t),n&&(e.didRenderFromCache=n),e},t.updateCustomerPromiseLKGStatus=function(e,t,n){return n?(e.hit=!1,e.failedReason=n&&n.message):(e.hit=!0,e.emptyData=t),e},t.updateCustomerDataProviderStatus=function(e,t,n,a){return e.dataSource=t,a?(e.apiSuccess=!1,e.apiFailedReason=a&&a.message):(e.apiSuccess=!0,e.emptyData=n),e},t}(),fe=U(889);const pe=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,e.__extends)(n,t),n}(function(t){function n(e){var n=t.call(this,e)||this;return n._cacheManager=e.serviceScope.consume(X.serviceKey),n}return(0,e.__extends)(n,t),n.prototype.requestData=function(e){return i.Validate.isNotNullOrUndefined(e,"request"),i.Validate.isNotNullOrUndefined(e.fetchData,"request.fetchData"),i.Validate.isNotNullOrUndefined(e.dataReceived,"request.dataReceived"),i.Validate.isNonemptyString(e.cacheKey,"request.cacheKey"),i.Validate.isNonemptyString(e.alias,"request.alias"),(0,x.MF)()&&"ImageGalleryWebPart"===e.alias?this._cacheManager.requestWebPartCacheData({requestData:e.fetchData,dataUpdated:e.dataReceived,serializedConfiguration:JSON.stringify(e.cacheParameters),webPartInstanceId:e.cacheKey,webPartAlias:e.alias}).then(function(e){return e.cacheResponseAsync||e.serverResponseAsync}).then(function(e){return e}):this._cacheManager.requestWebPartCacheData_deprecated({requestData:e.fetchData,dataUpdated:e.dataReceived,config:e.cacheParameters,webPartInstanceId:e.cacheKey,webPartAlias:e.alias,webPartTag:e.alias})},n}(function(e){i.Validate.isNotNullOrUndefined(e,"configuration"),i.Validate.isNotNullOrUndefined(e.serviceScope,"configuration.serviceScope"),this.configuration=e}));var me=function(t){function n(){var e=null!==t&&t.apply(this,arguments)||this;return e._internalDataReceived=function(t){e.dataReceived({data:t,metadata:{}})},e}return(0,e.__extends)(n,t),Object.defineProperty(n.prototype,"dataProviderConfiguration",{get:function(){return{serviceScope:this.context.serviceScope}},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"dataProvider",{get:function(){return this._dataProvider||(this._dataProvider=new pe(this.dataProviderConfiguration)),this._dataProvider},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"cacheKey",{get:function(){return this.context.instanceId},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"alias",{get:function(){return this.context.manifest.alias},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"cacheParameters",{get:function(){return this.properties},enumerable:!1,configurable:!0}),n.prototype._internalGetData=function(){var e={fetchData:this.fetchData,dataReceived:this._internalDataReceived,cacheKey:this.cacheKey,alias:this.alias,cacheParameters:this.cacheParameters,webPartTag:this.context&&this.context.webPartTag};return this.dataProvider.requestData(e).then(function(t){e.dataReceived({data:t,metadata:{}})})},n}($.BaseClientSideWebPart),_e=U(111);function he(e,t){return!(!e||!t)&&e.getFullYear()===t.getFullYear()&&e.getMonth()===t.getMonth()&&e.getDate()===t.getDate()}c.loadStyles('.u_e_658c9e0a{align-items:center;border:1px solid;color:"[theme:neutralPrimary, default: #323130]";display:flex;flex-direction:column;font-weight:400;text-align:center}.u_e_658c9e0a.v_e_658c9e0a{height:62px;width:62px}.u_e_658c9e0a.w_e_658c9e0a{height:80px;width:80px}.u_e_658c9e0a.x_e_658c9e0a{height:104px;width:104px}.u_e_658c9e0a.y_e_658c9e0a{justify-content:center}.u_e_658c9e0a.z_e_658c9e0a{justify-content:space-between}.v_e_658c9e0a .aa_e_658c9e0a:not(.ab_e_658c9e0a){font-size:12px;font-weight:400}.w_e_658c9e0a .aa_e_658c9e0a:not(.ab_e_658c9e0a){font-size:15px;font-weight:400}.x_e_658c9e0a .aa_e_658c9e0a:not(.ab_e_658c9e0a){font-size:21px;font-weight:100}.v_e_658c9e0a .aa_e_658c9e0a.ab_e_658c9e0a{font-size:"[theme:smallFontSize, default: 12px]";font-weight:"[theme:smallFontWeight, default: 400]";font-weight:600}.w_e_658c9e0a .aa_e_658c9e0a.ab_e_658c9e0a{font-size:"[theme:mediumFontSize, default: 14px]";font-weight:"[theme:mediumFontWeight, default: 400]";font-weight:600}.x_e_658c9e0a .aa_e_658c9e0a.ab_e_658c9e0a{font-size:"[theme:xLargeFontSize, default: 20px]";font-weight:"[theme:xLargeFontWeight, default: 600]";font-weight:600}.ac_e_658c9e0a{font-weight:600}.v_e_658c9e0a .ac_e_658c9e0a:not(.ab_e_658c9e0a){font-size:21px}.w_e_658c9e0a .ac_e_658c9e0a:not(.ab_e_658c9e0a),.x_e_658c9e0a .ac_e_658c9e0a:not(.ab_e_658c9e0a){font-size:28px}.v_e_658c9e0a .ac_e_658c9e0a.ab_e_658c9e0a{font-size:"[theme:xLargeFontSize, default: 20px]";font-weight:"[theme:xLargeFontWeight, default: 600]"}.w_e_658c9e0a .ac_e_658c9e0a.ab_e_658c9e0a,.x_e_658c9e0a .ac_e_658c9e0a.ab_e_658c9e0a{font-size:"[theme:xxLargeFontSize, default: 28px]";font-weight:"[theme:xxLargeFontWeight, default: 600]"}.ae_e_658c9e0a{display:flex;flex-direction:column;flex-grow:1;justify-content:center}.v_e_658c9e0a .ae_e_658c9e0a:not(.ab_e_658c9e0a){font-size:10px;font-weight:600}.w_e_658c9e0a .ae_e_658c9e0a:not(.ab_e_658c9e0a){font-size:12px;font-weight:400}.x_e_658c9e0a .ae_e_658c9e0a:not(.ab_e_658c9e0a){font-size:15px;font-weight:400}.v_e_658c9e0a .ae_e_658c9e0a.ab_e_658c9e0a{font-size:"[theme:xSmallFontSize, default: 10px]";font-weight:"[theme:xSmallFontWeight, default: 400]";font-weight:600}.w_e_658c9e0a .ae_e_658c9e0a.ab_e_658c9e0a{font-size:"[theme:smallFontSize, default: 12px]";font-weight:"[theme:smallFontWeight, default: 400]";font-weight:600}.x_e_658c9e0a .ae_e_658c9e0a.ab_e_658c9e0a{font-size:"[theme:mediumPlusFontSize, default: 16px]";font-weight:"[theme:mediumPlusFontWeight, default: 400]";font-weight:600}.af_e_658c9e0a{border:0;border-bottom:1px solid;margin:0}.v_e_658c9e0a .af_e_658c9e0a{width:31px}.w_e_658c9e0a .af_e_658c9e0a{width:40px}.x_e_658c9e0a .af_e_658c9e0a{width:52px}',!0);const be="u_e_658c9e0a",ge="ab_e_658c9e0a",ve="ae_e_658c9e0a",ye=JSON.parse('{"v":"Month"}');var Se={Small:0,Medium:1,Large:2},De={0:"v_e_658c9e0a",1:"w_e_658c9e0a",2:"x_e_658c9e0a"};const Ie=function(n){function a(){return null!==n&&n.apply(this,arguments)||this}return(0,e.__extends)(a,n),a.prototype.render=function(){var e=this.props,t=e.startDate,n=e.endDate;return this._sizeClassName=h.get(De,this.props.size),t&&n&&!he(t,n)?this._multipleDaysDateBoxElement:this._singleDayDateBoxElement},Object.defineProperty(a.prototype,"_singleDayDateBoxElement",{get:function(){var e=this.props,n=e.startDate,a=e.endDate,i=e.formatMonth,r=e.formatDay,s=n||a,c=s?i(s):ye.v,d=s?r(s):"01";return t.createElement("div",{className:(0,o.css)(be,"y_e_658c9e0a",this._sizeClassName,this.props.className),"data-automation-id":"singleDayBox"},t.createElement("div",{className:(0,o.css)("aa_e_658c9e0a",ge),"data-automation-id":"singleDayMonthContainer"},c),t.createElement("div",{className:(0,o.css)("ac_e_658c9e0a",ge),"data-automation-id":"singleDayDayContainer"},d))},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"_multipleDaysDateBoxElement",{get:function(){var e=this.props,n=e.startDate,a=e.endDate,i=e.formatDate;return t.createElement("div",{className:(0,o.css)(be,"z_e_658c9e0a",this._sizeClassName,this.props.className),"data-automation-id":"multipleDayBox"},t.createElement("div",{className:(0,o.css)(ve,ge),"data-automation-id":"multipleDayStartDateContainer"},i(n)),t.createElement("hr",{className:"af_e_658c9e0a"}),t.createElement("div",{className:(0,o.css)(ve,ge),"data-automation-id":"multipleDayEndDateContainer"},i(a)))},enumerable:!1,configurable:!0}),a.defaultProps={formatDate:function(e){return _e.LocaleFormat.formatDate(e,{skeleton:"MMMd"}).toUpperCase()},formatMonth:function(e){return _e.LocaleFormat.formatDate(e,{skeleton:"MMM"}).toUpperCase()},formatDay:function(e){return _e.LocaleFormat.formatDate(e,{skeleton:"d"})}},a}(t.PureComponent),xe=JSON.parse('{"v":"{0} at {1}"}');var Ce=36e5;function Oe(e,t){return t||(e=-e),new Date(Date.now()+e)}function we(e){var t=e.split("|");if("0"===t[0])return t[1];var n="1"===t[1],a=t[2],r=t.length>=4?t[3]:void 0,o=Number(r),s=t.length>=5?t[4]:void 0;switch(a){case"1":return _e.LocaleFormat.formatRelativeTimeApproximate(Oe(1e3,n));case"2":return _e.LocaleFormat.formatRelativeTimeApproximate(Oe(6e4,n));case"3":return _e.LocaleFormat.formatRelativeTime(n?o:-o,"minute");case"4":return _e.LocaleFormat.formatRelativeTimeApproximate(Oe(Ce,n));case"5":var c=_e.LocaleFormat.formatRelativeTime(n?1:-1,"day");return r?i.Text.format(xe.v,c,r):c;case"6":return _e.LocaleFormat.formatRelativeTimeApproximate(Oe(o*Ce,n));case"7":return s?i.Text.format(xe.v,r,s):r;case"8":return _e.LocaleFormat.formatRelativeTime(n?o:-o,"day");case"9":return _e.LocaleFormat.formatRelativeTime(0,"day")}}const Ee=function(){function e(e,t,n){this._target=e,this._displayField=t,this._onRenderCell=n}return Object.defineProperty(e.prototype,"target",{get:function(){return this._target},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"sources",{get:function(){return this._displayField.sources||[]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"linkUrls",{get:function(){return this._displayField.linkUrls||[]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"heading",{get:function(){return this._displayField.heading||""},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return void 0===this._displayField.width||null===this._displayField.width?100:this._displayField.width},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onRenderCell",{get:function(){return this._onRenderCell},enumerable:!1,configurable:!0}),e}(),Ae=function(t){function n(e,n,a,i){var r=t.call(this,e,n,i)||this;return r._formatter=a,r}return(0,e.__extends)(n,t),Object.defineProperty(n.prototype,"formatter",{get:function(){return this._formatter},enumerable:!1,configurable:!0}),n}(Ee);var Le="_linkUrl";const ke=function(){function e(e){this._map=e}return e.prototype.fieldValue=function(e,t){return e instanceof Ae?e.formatter(t):this._firstIdentifiedValue(t,e.sources)},e.prototype.fieldLinkUrl=function(e,t){return this._firstIdentifiedValue(t,e.linkUrls)},e.prototype.transposeRow=function(e,t){if(!e)return e;var n=t?t(e):e,a={};if(this._map)for(var i=0;i<this._map.length;i++){var r=this._map[i];a[r.target]=this.fieldValue(r,n),r.linkUrls&&(a[r.target+Le]=this.fieldLinkUrl(r,n))}return a},e.prototype.transpose=function(e,t){for(var n=[],a=0;a<e.length;a++)n[a]=this.transposeRow(e[a],t);return n},Object.defineProperty(e.prototype,"map",{get:function(){return this._map},enumerable:!1,configurable:!0}),e.prototype._firstIdentifiedValue=function(e,t){for(var n=0;n<t.length;n++){var a=t[n],i=e[a];if(null!=i&&""!==i)return e[a]}},e}();var Me=function(){function e(){}return e.prototype.getClassNames=function(e,t){return void 0===t&&(t=!0),!t&&this._cachedClassNames||(this._cachedClassNames=(0,o.classNamesFunction)()(this.getStyles,e)),this._cachedClassNames},e}();function Pe(e){"aspx"===(l.ExtensionHelper.getExtension(new v.Uri(e))||"")||i._BrowserUtilities.isTeamsHosted()?postMessage("router://".concat(e),location.origin):window.open(e,Te(e))}function Te(e,t){return t||Ue(e)?"_blank":"_self"}function Ue(e){if(!e)return!1;var t=new v.Uri(e).getHost();return Boolean(t)&&t.toLocaleLowerCase()!==window.location.host.toLowerCase()}var Fe=U(137);function He(e){var t=e.pageContext,n=e.url,a=e.siteId,i=e.webId,r=e.uniqueId,o=e.callerId,s=e.originalWidth,c=e.originalHeight;if(n&&0!==n.indexOf("/_LAYOUTS/IMAGES/")){var d=new Fe._SPResourcePath(n),u=Fe._PreviewUtility.getFileExtension(d)||"";if(l.PreviewHelper.hasThumbnailOrFileTypeSupportsPreview(u,void 0)||"gif"===u){var f,p=Fe._ThumbnailUrlGenerator.getThumbnailProvider(n);switch(p){case Fe._ThumbnailProviderType.SPOLayoutsImage:f=n;break;case Fe._ThumbnailProviderType.PrivateCDN:case Fe._ThumbnailProviderType.AFDPrivateCDN:case Fe._ThumbnailProviderType.MeTA:case Fe._ThumbnailProviderType.Stock:case Fe._ThumbnailProviderType.VROOMMeTACache:return;case Fe._ThumbnailProviderType.HubbleStockThumbnail:case Fe._ThumbnailProviderType.HubbleStock:f=n;break;case Fe._ThumbnailProviderType.PublicCDN:case Fe._ThumbnailProviderType.MediaCDNHubble:f=Fe._ThumbnailUrlGenerator.updateThumbnailWidth(n,400)}if((null==f?void 0:f.length)<=255)return f;var m,_=t&&t.web.absoluteUrl||window.location.href,h=new v.Uri(_).getLeftPart(1),b=!!(a&&i&&r),g=!(t&&t.web&&t.web.serverRelativeUrl&&n)||-1===n.toUpperCase().indexOf(t.web.serverRelativeUrl.toUpperCase());return n&&(p===Fe._ThumbnailProviderType.SharePointHost||p===Fe._ThumbnailProviderType.MySite||d.isInternalResource(t))&&(b=!0,d.format===Fe._SPResourcePathFormat.absolute?(h=d.authority,m=d.path):m=n),b&&(f=l.PreviewHelper.getPreviewImageUrl(u,void 0,h,m,a,i,r,void 0,!0,o,s,c))&&f.length<=255?f:(f=function(e,t,n,a){var i=a&&a.web.absoluteUrl,r=""!==new v.Uri(e).getHost(),o=n?t:i,s=n?e:e.substr(a.web.serverRelativeUrl.length);return r?e:v.Uri.concatenate(o,s)}(n,h,g,t),f.length<=255?f:void 0)}}}var Re=U(89),Ne=new Set(["03590920bdfd864322cf7e8cca891bb4","0381c1bcfc0b809623b805e322dd9fa1","03d374b16722d252588fa2d58a3e828d","0540187fe91e3b78e3b5d06999eebf80","083313c7a8083e625c0def330dbd7cdd","0974242efa7f7b9bb52240ee615b931b","0bbb13911b2ce26da17bbdf2ea3404b6","0d827eba349aa0591be57331540fc4f4","0e47add0cdf9530b9e30ddef0c489a40","0f78c3aa1a3da070d8f62bb9a2ee76ae","0fe8fe2f5220263be4cbd5f61d9cf23c","178a70df6ddfa637e3d4f0ea9a80fbdd","1a960363e8daa165d3b82144b0d68c03","1e033e719ef573ec796c38bf8ac41dfc","1f420b466365299439abf6fe2f8bff6a","20f0b5fb7de21fa889b002714ec58f20","2149d6090d915f849f5c33c07545fb03","23d161d98611bae938697c4d0af3bfd4","241b2579d59d10255b2e405fbcbb9117","26736ef07954f237039d261c357f06e5","279ec9ccb88c02985b4e1f645b755faf","2d523e15f73a2b345887c8b8299c8d3c","2fce211aefcaec7742455aa616edfa32","2f73a4291c58a29acc783b73fa88c282","3178a5744ef0cd2b61757583d7b7ccf1","319f83a0e835d32ce2660a4de654a7c0","3a9c8d1a8fae79004ed36c0147bdd71b","3fa3e0b2e84cb77f00799dca10f1a03e","4a48f26592f4e1498d7a478a4c48609c","41ebba55d20ff0a87734a09d88dc8f27","4312d1e9ec65cb2412e83a64f50fcdd1","44f2e736a8f04d1b47a1151eb37e0a64","48e8c755618be2d66c67976910bac81f","49fe29d48bd08304cb7a9be0a4256b8a","5b60516651aebbbc796eafdee967ef2c","613c9c11d6bfdec3dd2a568412b79762","62fe9bb236110e4553483b02e1989986","68df1aaa4d4d20f6749dcf0cbcbfd182","6c06b3944a82b194dd56b848d5c1e53f","6fe016add870f202c0a30c70ee943c73","7024c1dc5ed913c848ac81adadfedee4","7ad602295f8386b7615b582d87bcc294","7f25de15c2e701c901252f81c1911af2","8193ab3946149e9175a3c3d44219e9e1","8a2bceaca7e84b8f4da535d772625c6f","8a430e2d85dc31b60c0c6f68d7cc4c20","8b02cb6c9f9d7a7e895970d94317e20a","8ddba906d9614422695d3c9756afee7f","8f296bb8aac7be4f08409d8dbbbc8714","9029ea4d3ee7796fe043710dfff1d218","90ac8c284c2ac3a6f6b7e6518dbb6227","965331b9e159f7e263f86866902241e8","98f88501895b89e844d24793dadc8a9f","9a85f4ab720503d37748e2d854a238dc","9aae9266066558e0e42223ed4d82b1f8","a284f85a5a3096a5e90f670316993365","a3f3c88a874da09d43c8f88deb9246b6","ab08afa407a9c009513a07525fadf367","ba3cc3f8be4b187472e2f5f7d5376bb9","b3b9212834745aa4457f459f12e56653","b8a930a9d063513ea9bba50a34aaaba5","b8f6d5994ef9e9a96180ea43dbb00ed6","baa367f8c4aef7abdcb912c61f53ed10","bc4fab3f78291f699922e57650be557f","c065f1d4e77c3678be1ff6aa835dda69","c4ae58fb4e94e08cfff98beddeb615ac","c63681d72227d0813a5cdfccb62be638","c903233a37600953361096a5c28d0d46","c9dc379c327bef6f8db124f5f013fe22","cbcecad0b1eb14fe8186c566f22b0fa1","cd26d43c2fabf764bfc054d06462f64f","cd849e71a1785cc1f046b181e68bbec3","d283507fbbeb97715a321ddbd2442164","d6c8114c17555266c90ad015c2acd8b9","dacd2fb8ace0a4176a74a228539b3d33","e6ede0691f3312bd6fd9f1066153a868","e72abfe847c8792f99bc8b2cbeb65886","ea754dbc9eba7d06ae4b444f722c24df","f0d90ca687e974534dfc12798166c7e6","ffb18190d6e56748b5d6d743ff7421ad"]),Be="DoughboyDetector",je="CDNUserPhoto",Ve="AFDCDNUserPhoto",ze=function(t){function n(e){var a=t.call(this,e)||this;a._unmounted=!1,a._completeDetection=function(){a.props.onDetectCompleted&&a.props.onDetectCompleted()},a._revokeBlobUrl=function(){a._blobUrl&&(URL.revokeObjectURL(a._blobUrl),a._blobUrl=void 0)},a._logSource=r._LogSource.create("DoughboyDetector"),i._SPKillSwitch.isActivated("6054fa5e-2661-4947-9381-197a14758c1f")||Ne.add("07685baa515ccd7f52defd1043fca4cc");var o=n._imageDataCache.get(e.imageUrl);return a.state={imageData:o},a}return(0,e.__extends)(n,t),n.prototype.componentDidMount=function(){var e=this;this.state.imageData?requestAnimationFrame(this._completeDetection):this.props.disableDelayDetect?this._resolveImage(this.props.imageUrl).then(this._completeDetection,this._completeDetection):setTimeout(function(){e._resolveImage(e.props.imageUrl).then(e._completeDetection,e._completeDetection)},7e3)},n.prototype.UNSAFE_componentWillReceiveProps=function(e){var t=this;if(this.props.imageUrl!==e.imageUrl){var a=n._imageDataCache.get(e.imageUrl);a?this.setState({imageData:a}):this._resolveImage(e.imageUrl).catch(function(e){return r._TraceLogger.logError(t._logSource,e,"ResolveImage")})}},n.prototype.componentWillUnmount=function(){this._unmounted=!0,this._revokeBlobUrl()},n.prototype.render=function(){return this.props.renderImage(this.state.imageData||"",this.props.imageProps,this._extraProps)},n.prototype._resolveImage=function(e){var t=this;return new Promise(function(a,o){var s=document.createElement("img");s.onload=function(){var i=t._getImageBase64(s),c=(0,l.Md5Hash)(i);if(Ne.has(c))r._EngagementLogger.logEventWithLogEntry(new r._LogEntry("DoughboyDetector","IsDoughboyImage",r._LogType.Event,{fingerprint:c})),o(new l.ExpectedFailure("DoughboyImageDetected"));else if(t._unmounted)o(new l.ExpectedFailure("ElementUnmounted"));else{var d="data:image/png;base64,".concat(i);t.setState({imageData:d}),n._imageDataCache.set(e,d),a()}},s.onerror=function(e){o(new l.ExpectedFailure("DownloadImageFailed",e.error))},i._SPKillSwitch.isActivated("a2a16402-2f33-4194-9f64-0401227d07bd")?s.src=e:t._downloadImageBlob(e).then(function(e){t._revokeBlobUrl(),t._blobUrl=URL.createObjectURL(e),s.src=t._blobUrl}).catch(function(){return s.src=e}),s.crossOrigin="anonymous"})},n.prototype._downloadImageBlob=function(e){var t=this;return new Promise(function(n,a){var o,s=i._SPKillSwitch.isActivated("debde2df-6396-4e00-a52b-9f0e28593f6f"),c=new XMLHttpRequest;c.open("GET",e),c.responseType="blob";var d="";if(!s){var l=e.toLowerCase();d=l.indexOf("/_layouts/15/userphoto.aspx")>-1?"UserPhoto":l.indexOf("_vti_bin/afdcache.ashx/_userprofile/userphoto.jpg")>-1?Ve:l.indexOf("https://privatecdn")>-1&&l.indexOf("/_userprofile/userphoto.jpg")>-1?je:"Unknown",o=new r._QosMonitor("UserPhotoRenderService.".concat(d))}c.onload=function(){if(c.status>=200&&c.status<300&&c.response){if(!s){var i=d===je||d===Ve?c.getResponseHeader("x-cache"):"",r=d===Ve?c.getResponseHeader("x-ccc"):"",l=c.getResponseHeader("x-cache-origin");o.writeSuccess({service:d,alias:Be,statusCode:c.status,CDNCache:null==i?void 0:i.split(" ")[0],OriginCache:l,cacheCountryCode:r,size:c.response.size,source:c.response.type})}return n(c.response)}var u=c.getResponseHeader("location");if(u&&c.status>=300&&c.status<400)return t._downloadImageBlob(u).then(n).catch(a);if(!s){var f=new Error("<url>".concat((0,Re.scrubUrl)(void 0,e),"</url> <errorCode>").concat(c.status,"</errorCode>"));404===c.status?o.writeExpectedFailure("".concat(d," failed"),f,{alias:Be,statusCode:c.status}):o.writeUnexpectedFailure("".concat(d," failed"),f,{alias:Be,statusCode:c.status})}a("")},c.onerror=function(){if(!s){var t=new Error("<url>".concat((0,Re.scrubUrl)(void 0,e),"</url> <errorCode>").concat(c.status,"</errorCode>"));o.writeUnexpectedFailure("".concat(d," failed"),t,{alias:Be,headers:c.getAllResponseHeaders()})}a("")},c.send()})},n.prototype._getImageBase64=function(e){var t,n=document.createElement("canvas");n.width=e.width,n.height=e.height,n.getContext("2d").drawImage(e,0,0);try{t=n.toDataURL("image/png"),this._revokeBlobUrl()}catch(e){return""}return t.replace(/^data:image\/png;base64,/,"")},Object.defineProperty(n.prototype,"_extraProps",{get:function(){var t=this.props;return t.imageUrl,t.imageProps,t.renderImage,t.onDetectCompleted,(0,e.__rest)(t,["imageUrl","imageProps","renderImage","onDetectCompleted"])},enumerable:!1,configurable:!0}),n._imageDataCache=new Map,(0,e.__decorate)([(0,l.monitor)("DoughboyDetector.ResolveImage")],n.prototype,"_resolveImage",null),n}(t.Component);c.loadStyles(".r_b_658c9e0a{word-wrap:break-word!important}",!0);const Ge=function(n){function a(e){var a=n.call(this,e)||this;return a.update=function(){a._textContainerElementRef.current&&a._async.requestAnimationFrame(a._truncateLines)},a._truncateLines=function(){if(a._textContainerElementRef.current){var e=a.props.text||"";a._textContainerElementRef.current.textContent=e;var t=Math.round(a.props.lines),n=window.getComputedStyle(a._textContainerElementRef.current,void 0).getPropertyValue("line-height"),i=t*parseFloat(n),r=a._contentHeight;a._textArray=e.split("");var o=r>i&&t>0;if(o){var s=a._trimAndCalculateLength(r,i);a._applyTextNumber(s)}o&&a.props.autoShowTitle?a._textContainerElementRef.current.title=e:a._textContainerElementRef.current.removeAttribute("title"),a.props.onAfterTruncate&&a.props.onAfterTruncate(o)}},a._async=new o.Async(a),a._eventGroup=new o.EventGroup(a),a._handleWindowResize=a._async.debounce(a._handleWindowResizeCore,1010),a._textContainerElementRef=t.createRef(),a}return(0,e.__extends)(a,n),a.prototype.componentDidMount=function(){this._async.setTimeout(this.update,0),this._eventGroup.on(window,"resize",this._handleWindowResize)},a.prototype.componentDidUpdate=function(){this.update()},a.prototype.componentWillUnmount=function(){this._eventGroup.off(window,"resize",this._handleWindowResize),this._eventGroup.dispose(),this._async.dispose()},a.prototype.render=function(){return t.createElement("div",(0,e.__assign)({},(0,o.getNativeProps)(this.props,o.divProperties),{"data-automation-id":"less-text",ref:this._textContainerElementRef,className:(0,o.css)("r_b_658c9e0a",this.props.className)}),this.props.text)},Object.defineProperty(a.prototype,"_omission",{get:function(){return this.props.omission||""},enumerable:!1,configurable:!0}),a.prototype._handleWindowResizeCore=function(){this.update()},Object.defineProperty(a.prototype,"_contentHeight",{get:function(){if(this._textContainerElementRef.current){var e=window.getComputedStyle(this._textContainerElementRef.current),t=0;return e&&e.paddingTop&&e.paddingBottom&&(t=parseFloat(e.paddingTop)+parseFloat(e.paddingBottom)),this._textContainerElementRef.current.offsetHeight-t}return 0},enumerable:!1,configurable:!0}),a.prototype._trimAndCalculateLength=function(e,t){var n=this._textArray.length;if(!this._textContainerElementRef.current)return n;var a=1,i=n;do{var r=Math.floor((a+i+1)/2);this._applyTextNumber(r),this._contentHeight>t?i=r-1:a=r}while(a<i);return a},a.prototype._applyTextNumber=function(e){var t=this._textArray.slice(0,e).join("");this._textContainerElementRef.current&&(this._textContainerElementRef.current.textContent=this._textContainerElementRef.current.textContent===t?t:t+this._omission)},a}(t.PureComponent);function Ke(e,t){void 0===t&&(t=1.35);var n=void 0;if("number"==typeof t)n="".concat(e*t,"em");else try{var a=e*Number(t.substr(0,t.length-2));if(isNaN(a))throw new Error("Invalid line height input");n="".concat(a,"px")}catch(e){throw new e("Invalid line-height input format")}return{overflow:"hidden",display:"-webkit-box","-webkit-box-orient":"vertical","-webkit-line-clamp":e.toString(),boxSizing:"content-box",maxHeight:n,textOverflow:1===e?"ellipsis":void 0}}var We=function(e,t,n){return{".ms-Fabric--isFocusVisible &:focus::after":{border:"1px solid ".concat(e),borderRadius:t,inset:"0",outline:"2px solid ".concat(n)}}};function qe(t){var n=t.theme,a=t.primary;return(0,o.concatStyleSets)(function(e){return{root:{paddingLeft:"12px",paddingRight:"12px",borderRadius:e.effects.roundedCorner4}}}(n),a?function(t){var n=t.effects,a=t.palette,i=t.semanticColors;return{root:(0,e.__assign)((0,e.__assign)({backgroundColor:i.primaryButtonBackground,borderColor:i.primaryButtonBorder,color:i.primaryButtonText},We(a.white,n.roundedCorner4,i.focusBorder)),{".ms-Fabric--isFocusVisible &:focus":{"@media screen and (-ms-high-contrast: active), screen and (forced-colors: active)":{outline:"2px solid buttontext"}}}),rootHovered:{backgroundColor:i.primaryButtonBackgroundHovered,borderColor:i.primaryButtonBackgroundHovered,color:i.primaryButtonTextHovered},rootPressed:{backgroundColor:i.primaryButtonBackgroundPressed,borderColor:i.primaryButtonBackgroundPressed,color:i.primaryButtonTextPressed},rootDisabled:{backgroundColor:i.primaryButtonBackgroundDisabled,borderColor:i.primaryButtonBackgroundDisabled,color:i.primaryButtonTextDisabled}}}(n):function(t){var n=t.effects,a=t.palette,i=t.semanticColors;return{root:(0,e.__assign)({borderColor:i.buttonBorder,color:i.buttonText},We("transparent",n.roundedCorner4,i.focusBorder)),rootHovered:{backgroundColor:i.buttonBackgroundHovered,borderColor:a.neutralTertiaryAlt,color:i.buttonTextHovered},rootPressed:{backgroundColor:i.buttonBackgroundPressed,borderColor:a.neutralTertiary,color:i.buttonTextPressed},rootDisabled:{backgroundColor:i.buttonBackgroundDisabled,borderColor:i.buttonBorderDisabled,color:i.buttonTextDisabled}}}(n))}var Qe=function(){function e(){this._x=0,this._y=0,this._line=1,this._whitespace=/(?!\xA0)\s/,this._hyphen=/\u2010|\u002d|\u00ad/,this._metrics={}}return Object.defineProperty(e,"instance",{get:function(){return e._instance||(e._instance=new e)},enumerable:!1,configurable:!0}),e.prototype.clampText=function(e){return this._resetCursor(),this._clampText(e)},e.prototype.clampElement=function(e,t,n,a){if(!e)return{text:"",lines:0};var i=e.getBoundingClientRect(),r=Math.round(i.width),o=Math.round(i.height),s=this._getComputedStyle(e);"border-box"===s.boxSizing&&(r-=this._parseInt(s.borderRightWidth)+this._parseInt(s.borderLeftWidth)+this._parseInt(s.paddingRight)+this._parseInt(s.paddingLeft),o-=this._parseInt(s.borderTopWidth)+this._parseInt(s.borderBottomWidth)+this._parseInt(s.paddingTop)+this._parseInt(s.paddingBottom)),window.MSInputMethodContext&&document.documentMode&&--r;var c=parseFloat(s.fontSize),d=1.1*c,l=Math.floor("normal"===s.lineHeight?d:parseFloat(s.lineHeight));if(this._resetCursor(),e.childElementCount&&!n)return this._clampComplexElement(e,r,o,l,t,a);var u=this._clampText({text:n||e.textContent,maxLines:t,ellipsis:a,width:r,height:o,lineHeight:l,style:s.fontStyle||"",variant:s.fontVariant||"",weight:s.fontWeight||"",size:c,family:s.fontFamily||""});return e.textContent=u.text,u},e.prototype._getComputedStyle=function(e){var t="__computedStyle";return e[t]||(e[t]=getComputedStyle(e))},e.prototype._parseInt=function(e){var t=parseInt(e,10);return isNaN(t)?0:t},e.prototype._createCanvas=function(){var e=document.createElement("canvas");return e.width=1,e.height=1,e.getContext("2d")},e.prototype._resetCursor=function(){this._x=0,this._y=0,this._line=1},e.prototype._getFontStyle=function(e,t){return"".concat(e.style||"normal")+" ".concat(e.variant||"normal")+" ".concat(t||e.weight||"normal")+" ".concat(e.size,"px")+" ".concat(e.family||"sans-serif")},e.prototype._setFont=function(e){this._context||(this._context=this._createCanvas()),this._font=this._getFontStyle(e),this._numericWeight=parseInt(e.weight,10),(this._isExtendedWeight=!isNaN(this._numericWeight)&&400!==this._numericWeight&&700!==this._numericWeight)?(this._context2||(this._context2=this._createCanvas()),this._context.font=this._getFontStyle(e,"normal"),this._context2.font=this._getFontStyle(e,"bold")):this._context.font=this._font},e.prototype._measureChar=function(e){var t=this._metrics[this._font]||(this._metrics[this._font]={}),n=t[e];if(n)return n;if(n=this._context.measureText(e).width,this._isExtendedWeight){var a=(this._context2.measureText(e).width-n)/3;n-=(400-this._numericWeight)/100*a}return t[e]=n,n},e.prototype._clampText=function(e){var t,n,a=e.text,i=e.width,r=e.height,o=e.lineHeight,s=e.maxLines,c=e.ellipsis,d=void 0===c?"":c;if(!a||!a.length||!i||!r||r<o||!s)return{text:"",lines:0};this._setFont(e);var l=s===this._line;l&&(this._x+=this._measureChar(d));for(var u=a.length,f=0;f<u;){var p=a[f],m=this._whitespace.test(p);if(n&&m)++f;else{var _=this._measureChar(p);if(this._x+_>i){if(l)return{text:a.substring(0,n?f-1:f)+d,didClamp:!0,lines:this._line};t&&!m?f=t:m&&++f,this._y+=o,l=++this._line===s||this._y+2*o>r,this._x=l?this._measureChar(d):0,t=0}else(m||this._hyphen.test(p))&&(t=f),this._x+=_,++f;n=m}}return{text:a,lines:this._line}},e.prototype._clampComplexElement=function(e,t,n,a,i,r){for(var o,s=document.createTreeWalker(e,NodeFilter.SHOW_TEXT,null);o=s.nextNode();){var c=this._getComputedStyle(o.parentElement||o.parentNode),d=this._clampText({text:o.nodeValue,maxLines:i,ellipsis:r,width:t,height:n,lineHeight:a,style:c.fontStyle||"",variant:c.fontVariant||"",weight:c.fontWeight||"",size:parseFloat(c.fontSize),family:c.fontFamily||""});if(d.didClamp){for(o.nodeValue=d.text;o=s.nextNode();)o.parentNode.removeChild(o);return d}}},e}();function Ye(e){return Qe.instance.clampText(e)}function Je(e,t,n,a){return Qe.instance.clampElement(e,t,n,a)}var Xe=function(e){return Ye(e).text};c.loadStyles('.Placeholder{display:flex}.Placeholder.Placeholder--autoHeight .Placeholder-container{height:auto;padding:80px 0}.Placeholder .Placeholder-container{zoom:1;align-items:center;background-color:"[theme:neutralLighter, default: #f3f2f1]";box-sizing:border-box;color:"[theme:neutralSecondary, default: #605e5c]";height:326px;padding:80px 0 0;width:100%}.Placeholder .Placeholder-container:after,.Placeholder .Placeholder-container:before{content:"";display:table;line-height:0}.Placeholder .Placeholder-container:after{clear:both}.Placeholder .Placeholder-container .Placeholder-head{zoom:1;box-sizing:border-box;color:"[theme:neutralPrimary, default: #323130]";margin:0 -8px}.Placeholder .Placeholder-container .Placeholder-head:after,.Placeholder .Placeholder-container .Placeholder-head:before{content:"";display:table;line-height:0}.Placeholder .Placeholder-container .Placeholder-head:after{clear:both}.Placeholder .Placeholder-container .Placeholder-head .Placeholder-headContainer{height:100%;text-align:center;white-space:nowrap}.Placeholder .Placeholder-container .Placeholder-head .Placeholder-icon{display:inline-block;font-size:42px;font-weight:100;vertical-align:middle;white-space:normal}.Placeholder .Placeholder-container .Placeholder-head .Placeholder-text{display:inline-block;line-height:normal;vertical-align:middle;white-space:normal}[dir=ltr] .Placeholder .Placeholder-container .Placeholder-head .Placeholder-text{padding-left:16px}[dir=rtl] .Placeholder .Placeholder-container .Placeholder-head .Placeholder-text{padding-right:16px}.Placeholder .Placeholder-container .Placeholder-head .Placeholder-text:not(.Placeholder-text-fluent){font-size:28px;font-weight:100}.Placeholder .Placeholder-container .Placeholder-head .Placeholder-text.Placeholder-text-fluent{font-size:"[theme:xLargeFontSize, default: 20px]";font-weight:"[theme:xLargeFontWeight, default: 600]"}.Placeholder .Placeholder-container .Placeholder-head .Placeholder-text:not(.ellipsisKillSwitch){max-width:70%;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.Placeholder .Placeholder-container .Placeholder-description{zoom:1;box-sizing:border-box;margin:0 auto;text-align:center;vertical-align:middle;width:65%}.Placeholder .Placeholder-container .Placeholder-description:after,.Placeholder .Placeholder-container .Placeholder-description:before{content:"";display:table;line-height:0}.Placeholder .Placeholder-container .Placeholder-description:after{clear:both}.Placeholder .Placeholder-container .Placeholder-description .Placeholder-descriptionText{color:"[theme:neutralSecondary, default: #605e5c]";line-height:23px;margin:20px 0 28px}.Placeholder .Placeholder-container .Placeholder-description .Placeholder-descriptionText:not(.Placeholder-text-fluent){font-size:17px;font-weight:100}.Placeholder .Placeholder-container .Placeholder-description .Placeholder-descriptionText.Placeholder-text-fluent{font-size:"[theme:mediumPlusFontSize, default: 16px]";font-weight:"[theme:mediumPlusFontWeight, default: 400]"}.Placeholder .Placeholder-container .Placeholder-description .Placeholder-descriptionText:not(.Placeholder-text-truncate){display:inline-block}.Placeholder .Placeholder-container .Placeholder-description .Placeholder-descriptionText.Placeholder-text-truncate{-webkit-box-orient:vertical;-webkit-line-clamp:3;box-sizing:content-box;display:-webkit-box;max-height:69px;overflow:hidden}.Placeholder .Placeholder-container button{margin:2px 4px}.Placeholder-overlay{height:100%;position:relative;z-index:1}.Placeholder-overlay .Placeholder-spinnerContainer{margin:164px 0;position:relative;width:100%}',!0);const Ze=function(n){function a(){var e=null!==n&&n.apply(this,arguments)||this;return e._handleWindowResize=function(){a._shouldUseCssClamp||e._processLines()},e}return(0,e.__extends)(a,n),Object.defineProperty(a,"_shouldUseCssClamp",{get:function(){return void 0===this.__shouldUseCssClamp&&(this.__shouldUseCssClamp=i._BrowserDetection.getBrowserInformation().browser!==i._Browser.IE),this.__shouldUseCssClamp},enumerable:!1,configurable:!0}),a._isEllipsisOverflowKillSwitchActivated=function(){return i._SPKillSwitch.isActivated(i.Guid.parse("e984b51f-12c9-45ea-abba-2dc3869cdc79"),"2018/3/27","ReplaceOverflowingTitleTextWithEllipsis")},a.prototype.UNSAFE_componentWillMount=function(){this._processLines=this._async.throttle(this._processLines,500)},a.prototype.componentDidMount=function(){this._processLines(),window.addEventListener("resize",this._handleWindowResize)},a.prototype.componentDidUpdate=function(e){this.props.description&&this.props.webpartWidth!==e.webpartWidth&&this._processLines()},a.prototype.componentWillUnmount=function(){window.removeEventListener("resize",this._handleWindowResize)},a.prototype.render=function(){var e=this.props,n=e.children,i=e.contentClassName,r=e.description,s=e.icon,c=e.iconText;this._descriptionId="description-".concat(Math.random().toString());var d,l=(0,o.css)("Placeholder-descriptionText",{"Placeholder-text-fluent":!0,"Placeholder-text-truncate":a._shouldUseCssClamp});return this.props.placeholderHeight&&(d={height:"".concat(this.props.placeholderHeight,"px"),paddingTop:"".concat((this.props.placeholderHeight-150)/2,"px")}),t.createElement("div",{className:(0,o.css)("Placeholder",i,{"Placeholder--autoHeight":!!n})},t.createElement("div",{className:"Placeholder-container",style:d},t.createElement("div",{className:"Placeholder-head"},t.createElement("div",{className:"Placeholder-headContainer"},s&&t.createElement(o.Icon,{className:"Placeholder-icon",iconName:s}),t.createElement("span",{className:(0,o.css)("Placeholder-text",{ellipsisKillSwitch:a._isEllipsisOverflowKillSwitchActivated()},{"Placeholder-text-fluent":!0})},c))),t.createElement("div",{className:"Placeholder-description"},t.createElement("span",{className:l,id:this._descriptionId,ref:this._resolveRef("_placeholderDescription")},r)),n,t.createElement("div",{className:"Placeholder-description"},this.buttonElement,this._extraButtonElements)))},Object.defineProperty(a.prototype,"buttonElement",{get:function(){return this.props.buttonLabel&&this._renderButtonElement({description:this.props.description,label:this.props.buttonLabel,onClick:this.props.onAdd},!0)},enumerable:!1,configurable:!0}),a.prototype.focusOnPlaceHolderButton=function(){this._placeholderButton&&this._placeholderButton.focus()},Object.defineProperty(a.prototype,"_extraButtonElements",{get:function(){var e=this;return this.props.extraButtons&&this.props.extraButtons.map(function(t,n){return e._renderButtonElement(t,!1)})},enumerable:!1,configurable:!0}),a.prototype._processLines=function(){this._placeholderDescription&&!i._BrowserUtilities.isWebViewHosted()&&Je(this._placeholderDescription,3,this.props.description)},a.prototype._renderButtonElement=function(e,n){var a,i,r=t.createElement(m.PrimaryButton,{componentRef:n&&this._resolveRef("_placeholderButton"),"data-automation-id":"placeholderButton",onClick:e.onClick,ariaDescription:e.description},e.label);return(0,x.w7)()?(a=r,i={DefaultButton:{styles:qe}},t.createElement(s.Customizer,{scopedSettings:i},a)):r},a}(o.BaseComponent),$e=JSON.parse('{"Gg":"We need you to sign in again. Once you do, we\\u0027ll bring you back here.","S6":"Continue"}'),et=function(n){function a(){var e=null!==n&&n.apply(this,arguments)||this;return e._onLogin=function(){e._logAction("Click"),window.location.href=e.props.error.redirectUrl},e._logAction=function(t){var n=new r._LogEntry("OAuthErrorRenderer","MultiFactorAuthentication.".concat(t),r._LogType.Event,{webpartAlias:e.props.webpartAlias});r._EngagementLogger.logEventWithLogEntry(n)},e}return(0,e.__extends)(a,n),a.prototype.render=function(){var e=!!this.props.error.redirectUrl,n=e?$e.Gg:this.props.customErrorMessage||this.props.error.message;return t.createElement("div",{className:this.props.contentClassName},t.createElement(Ze,{icon:this.props.webpartIcon||"Permissions",iconText:this.props.webpartName,buttonLabel:e&&$e.S6,description:n,onAdd:e&&this._onLogin}))},a.prototype.componentDidMount=function(){this.props.error.redirectUrl&&this._logAction("Render")},a}(t.Component);var tt="data-sp-scroll-event-listener",nt="scroll",at="resize",it=function(){function e(){var t=this;this.register=function(e,n,a){t._scrollableParents&&t._scrollableParents.length||(t._scrollableParents=a?[a]:t._findScrollableParents(e)),t._scrollableParents.forEach(function(e,n,a){1===t._updateRegisteredChildren(e,1)&&t._listenEvents(e)}),t._listenEvents(window),t._eventListeners.add(n)},this._findScrollableParents=function(t){for(var n=[],a=t;a;)(a=e._findScrollableParent(a))&&(n.push(a),a=a.parentElement);return n.length?n:[document.body]},this._unlistenEvents=function(e){if(e){var n=e===window;(!n||n&&t._isListeningWindow)&&(t._removeEventListener(e),n&&(t._isListeningWindow=!1))}},this._updateRegisteredChildren=function(e,t){var n=t+Number(e.getAttribute(tt));return n>0?e.setAttribute(tt,n.toString()):e.removeAttribute(tt),n},this._eventListeners=new Set,this._isListeningWindow=!1,this._lazyHandler=h.throttle(this._scrollEventHandler,10).bind(this)}return Object.defineProperty(e,"instance",{get:function(){return void 0===e._instance&&(e._instance=new e),e._instance},enumerable:!1,configurable:!0}),e.prototype.unregister=function(e,t){var n=this;i.Validate.isNotNullOrUndefined(t,"unregister callback function"),this._eventListeners.has(t)&&(this._eventListeners.delete(t),(this._scrollableParents&&this._scrollableParents.length?this._scrollableParents:this._findScrollableParents(e)).forEach(function(e,t,a){n._updateRegisteredChildren(e,-1)<=0&&n._unlistenEvents(e)}),0===this._eventListeners.size&&this._unlistenEvents(window))},e.prototype._scrollEventHandler=function(e){var t=this;this._cachedClientRect&&!this._cacheExpired||(this._cachedClientRect=this._scrollableParents[this._scrollableParents.length-1].getBoundingClientRect(),this._cachedClientRectAge=Date.now()),this._eventListeners.forEach(function(n){n(e,t._cachedClientRect)})},e.prototype._listenEvents=function(e){if(e){var t=e===window;(!t||t&&!this._isListeningWindow)&&(this._addEventListener(e),t&&(this._isListeningWindow=!0))}},e.prototype._addEventListener=function(e){e.addEventListener(nt,this._lazyHandler,!1),e.addEventListener(at,this._lazyHandler,!1)},e.prototype._removeEventListener=function(e){e.removeEventListener(nt,this._lazyHandler),e.removeEventListener(at,this._lazyHandler)},Object.defineProperty(e.prototype,"_cacheExpired",{get:function(){return Date.now()-this._cachedClientRectAge>=100},enumerable:!1,configurable:!0}),e._findScrollableParent=function(e){for(var t=e,n=document.body;t&&t!==n;){if("true"===t.getAttribute("data-is-scrollable"))return t;t=t.parentElement}for(t=e;t&&t!==n;){var a=getComputedStyle(t);if(a){var i=a.getPropertyValue("overflow-y");if(i&&(i===nt||"auto"===i))return t}t=t.parentElement}return t&&t!==n||(t=void 0),t},e}();const rt=function(){function e(){var e=this;this._parallaxElements=new Set,this._parallaxFactor=1.81,this._onScroll=function(t,n){window.requestAnimationFrame(e._updateParallax.bind(e,n))},this._updateParallax=function(t){var n=t.top;e._parallaxElements.forEach(function(t){if(t.parentElement){var a=t.parentElement.getBoundingClientRect(),i=a.top,r=a.bottom;if(i<n&&r>n){var o=Math.round((n-i)/e._parallaxFactor);e._setTranslate(t,o)}else i>=n&&e._setTranslate(t,0)}})}}return Object.defineProperty(e,"instance",{get:function(){return void 0===e._instance&&(e._instance=new e),e._instance},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isParallaxEnabled",{get:function(){var e=i._BrowserDetection.getBrowserInformation();return e.browser!==i._Browser.Edge&&e.browser!==i._Browser.IE&&!i._BrowserUtilities.isWebViewHosted()},enumerable:!1,configurable:!0}),e.prototype.tryAddParallax=function(e){var t=this.isParallaxEnabled;if(t){i.Validate.isNotNullOrUndefined(e,"targetElement");var n=(0,o.findScrollableParent)(e),a=n===window?document.body:n;it.instance.register(e,this._onScroll,a),this._parallaxElements.add(e),e.style.setProperty("will-change","transform")}return t},e.prototype.removeParallax=function(e){i.Validate.isNotNullOrUndefined(e,"targetElement"),this._parallaxElements.has(e)&&(this._parallaxElements.delete(e),it.instance.unregister(e,this._onScroll),this._setTranslate(e,0),e.style.removeProperty("will-change"))},e.prototype._setTranslate=function(e,t){var n="translate3d(0px,"+t+"px, 0px)";e.style.transform=n},e}();function ot(e){return{type:e.type,targetProperty:e.targetProperty,shouldFocus:e.shouldFocus?e.shouldFocus:void 0,properties:e.properties}}function st(e){return e.map(function(e){return ot(e)})}function ct(e){var t=new v.Uri(e),n=t.getAuthority(),a=t.getPathSegments(),i=t.getQueryParameter("share");return!(0,h.isEmpty)(n)&&a.length>=4&&(/:[A-z]:/.test(a[0])&&/[A-z]/.test(a[1])||!(0,h.isEmpty)(i))}function dt(e,t){var n=new r._QosMonitor("redeemShareLinkMonitor"),a="u!"+window.btoa(e).trim().replace(/=+$/,"").replace("/","_").replace("+","-");return t.api("shares/".concat(a)).header("Prefer","redeemSharingLink").get().catch(function(e){return n.writeUnexpectedFailure("failedToRedeem",e),Promise.reject("Failed to redeem share link.")}).then(function(){return n.writeSuccess(),Promise.resolve()})}var lt=(0,o.classNamesFunction)(),ut=function(e){return e.variantTheme?{captionElement:[{selectors:{"& span":{color:e.variantTheme.semanticColors.bodyText},"& textarea":{color:e.variantTheme.semanticColors.bodyText+" !important"},"& textarea::placeholder":{color:e.variantTheme.semanticColors.bodySubtext+" !important"}}}]}:{captionElement:void 0}};const ft=function(n){function a(e){var a=n.call(this,e)||this;return a._captionElementRef=t.createRef(),a}return(0,e.__extends)(a,n),a.prototype.render=function(){var n=this.props,a=n.alignPosition,i=n.className,r=n.edit,s=n.marginBottomSize,c=n.onTitleChange,d=n.placeholder,l=n.title,u=n.theme,f=n.ariaLabel,p=n.headingLevel,m=n.pageContext,_=lt(ut,{variantTheme:u}).captionElement,h=(0,o.css)(i,_),g={type:b.RT.Title,isEditMode:r,text:l,onChange:c,placeholder:d,alignPosition:a,className:h,headingLevel:(0,x.eB)()&&p||2,marginBottomSize:s,ariaLabel:f,pageContext:m,useWebpartTitleStyles:M};return!(!r&&!l)&&t.createElement(b.XP,(0,e.__assign)({ref:this._captionElementRef},g))},a.prototype.value=function(){return this._captionElementRef.current.value()},a.prototype.focusOnWebPartTitle=function(){this._captionElementRef.current.focusOnCaptionElement()},a.defaultProps={edit:!1,title:void 0,onTitleChange:h.noop,placeholder:void 0,className:void 0,alignPosition:b.gM.PageDirection,marginBottomSize:"None"},a}(t.Component),pt=function(){function e(){}return e.getOpenDocumentAction=function(t){if(t&&i._BrowserUtilities.isWebViewHosted())return JSON.stringify({key:e.documentKey,args:{command:e.documentCommand,url:t,version:"1.0"}})},Object.defineProperty(e,"webViewActionRole",{get:function(){return i._BrowserUtilities.isWebViewHosted()&&!(i._BrowserUtilities.isTeamsWebViewHosted()||i._BrowserUtilities.isTeamsAndroidHosted()||i._BrowserUtilities.isTeamsIOSHosted())?"button":void 0},enumerable:!1,configurable:!0}),Object.defineProperty(e,"documentKey",{get:function(){return"openDocument"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"documentCommand",{get:function(){return"sitePageUserAction"},enumerable:!1,configurable:!0}),e}();function mt(){if(MouseEvent instanceof Function)return new MouseEvent("mousemove",{bubbles:!0,cancelable:!0});var e=document.createEvent("MouseEvent");return e.initEvent("mousemove",!0,!0),e}c.loadStyles(".bc_i_658c9e0a{cursor:pointer}.bc_i_658c9e0a:hover{outline:none}",!0);const _t=JSON.parse('{"Ww":"Opens Profile Card for {0}","qI":"Opens Profile Card","C2":"Getting details","dT":"Topic {0}"}');var ht=new(function(){function t(){}return t.prototype.getLPCLoader=function(){return Promise.all([U.e(296),U.e(505)]).then(U.bind(U,704)).then(function(e){return e.default})},(0,e.__decorate)([(0,l.monitor)("LivePersonaCard.Load")],t.prototype,"getLPCLoader",null),t}()),bt="Mouse";const gt=function(n){function a(e){var s=n.call(this,e)||this;return s._isUnMounted=!1,s.openCard=function(e){s._triggerBootstrap(e,bt),s._isLPCBundleLoaded()&&s._manuallyDispatchEventToTriggerCallout(mt())},s._bootstrapLivePersonaCard=function(e){return!a._isLivePersonaCardFlightEnabled()||i._BrowserUtilities.isMobileWebView()?Promise.resolve():a.livePersonaCardHoverTarget?(s._updateBundleMountedState(null==e?void 0:e.nativeEvent),Promise.resolve()):(s._loadPromise||(s._loadPromise=s._bootstrapCore(null==e?void 0:e.nativeEvent)),s._loadPromise)},s._bootstrapCore=function(e){return r._TraceLogger.logVerbose(s._logSource,"LivePersonaCard._bootstrapCore"),ht.getLPCLoader().then(function(e){return e.bootstrap(s.props.serviceScope,s._clientType,s._personaType,s.props.clientScenario,s.props.topicCardProps)}).then(function(){s._isUnMounted||s._updateBundleMountedState(e)}).catch(function(e){r._TraceLogger.logError(s._logSource,e,"BootstrapLivePersonaCard")})},s._manuallyDispatchEventToTriggerCallout=function(e){var t,n,a,r,c,d;if(!i._SPKillSwitch.isActivated("f3b11671-f43f-4e6d-8d17-b66bc86f4838")&&s.props.openCardBySpaceKeyOnly&&s._ref.current)return null===(t=(0,o.getFirstTabbable)(s._ref.current,s._ref.current,!0))||void 0===t||t.focus(),void(null===(n=s._ref.current.firstElementChild)||void 0===n||n.dispatchEvent(mt()));"keydown"===(null==e?void 0:e.type)&&s._ref.current&&(null===(a=(0,o.getFirstTabbable)(s._ref.current,s._ref.current,!0))||void 0===a||a.focus(),null===(r=s._ref.current.firstElementChild)||void 0===r||r.dispatchEvent(function(){if(KeyboardEvent instanceof Function)return new KeyboardEvent("keydown",{bubbles:!0,cancelable:!0,key:"Enter",code:"Enter",keyCode:13,which:13});var e=document.createEvent("KeyboardEvent");return e.initKeyboardEvent("keydown",!0,!0,window,"Enter","Enter",0,"",!1),e}())),"mouseover"===(null==e?void 0:e.type)&&s._ref.current&&s.state.shouldOpenLpcAfterBundleLoaded&&!s.props.disableHover&&(null===(c=s._ref.current.firstElementChild)||void 0===c||c.dispatchEvent(mt())),"click"===(null==e?void 0:e.type)&&s._ref.current&&s.state.shouldOpenLpcAfterBundleLoaded&&!s.props.disableClick&&(null===(d=s._ref.current.firstElementChild)||void 0===d||d.dispatchEvent(function(){if(MouseEvent instanceof Function)return new MouseEvent("click",{bubbles:!0,cancelable:!0});var e=document.createEvent("MouseEvent");return e.initEvent("click",!0,!0),e}()))},s._triggerBootstrap=function(e,t){r._EngagementLogger.logEventWithLogEntry(new r._LogEntry("LivePersonaCard","".concat(s._logScenario,".Trigger"),r._LogType.Event,{hasUPN:Boolean(s.props.legacyUpn||s.props.upn).toString(),source:t,isBundleLoaded:s.state.isBundleLoaded.toString()})),s._isLPCBundleLoaded()||(s.setState({shouldOpenLpcAfterBundleLoaded:!0}),s._bootstrapLivePersonaCard(e).catch(s._traceBootstrapFailure))},s._triggerBootstrapByKeyboard=function(e){"Enter"===e.key&&(s._triggerBootstrap(e,"Keyboard"),s._isLPCBundleLoaded()||(i._SPKillSwitch.isActivated("b0861b96-5b5e-484d-9bca-5f32b00504ac")?l.ScreenReaderAlert.read(_t.C2):d.read(_t.C2)))},s._handleCardOpen=function(){r._EngagementLogger.logEvent("LivePersonaCard.".concat(s._logScenario),"Open");var e=s.props.onCardOpen;e&&e()},s._traceBootstrapFailure=function(e){r._TraceLogger.logError(s._logSource,e,"LivePersonaCard.bootstrap")},s._logSource=r._LogSource.create("LivePersonaCard"),s._ref=t.createRef(),s.state={isBundleLoaded:!1,shouldOpenLpcAfterBundleLoaded:!1},s}return(0,e.__extends)(a,n),a._isLivePersonaCardFlightEnabled=function(){return i._SPFlight.isEnabled(809)},Object.defineProperty(a,"livePersonaCardHoverTarget",{get:function(){return window.LivePersonaCardHoverTargetV2},enumerable:!1,configurable:!0}),a.prototype.componentWillUnmount=function(){this._isUnMounted=!0},a.prototype.render=function(){var n=this;if(this.props.disabled)return t.Children.only(this.props.children);if(i._BrowserUtilities.isMobileWebView())return t.cloneElement(t.Children.only(this.props.children),{role:"button","data-sp-action":JSON.stringify({key:"viewUserProfileDetails",args:(0,e.__assign)({upn:this.props.legacyUpn},i._BrowserUtilities.isTeamsVivaMobile()&&{displayName:this.props.displayName})}),onClick:function(){}});var a=this.props.useSpan?"span":"div",r=this.props.disableClick?void 0:function(e){return n._triggerBootstrap(e,bt)},s=this.props.disableHover?void 0:function(e){return n._triggerBootstrap(e,bt)},c=this.props.disableHover?void 0:function(){n.setState({shouldOpenLpcAfterBundleLoaded:!1})};return t.createElement(a,{className:(0,o.css)(this.props.className,"bc_i_658c9e0a"),onClickCapture:r,onKeyDownCapture:this._triggerBootstrapByKeyboard,onMouseOver:s,onMouseLeave:c,ref:this._ref},this._renderContent())},a.prototype._renderContent=function(){var n,r,s,c={cardParameters:{personaInfo:{identifiers:(0,e.__assign)({PersonaType:this._personaType,Smtp:this.props.legacyUpn||this.props.email,Upn:this.props.legacyUpn||this.props.upn,TopicId:null===(n=this.props.topicCardProps)||void 0===n?void 0:n.topicId},this.props.hostAppPersonaInfo&&{LocationId:this.props.hostAppPersonaInfo.LocationId,OlsPersonaId:this.props.hostAppPersonaInfo.OlsPersonaId,AadObjectId:this.props.hostAppPersonaInfo.PersonaAadObjectId,DisplayName:this.props.hostAppPersonaInfo.PersonaDisplayName}),topicMetadata:null===(r=this.props.topicCardProps)||void 0===r?void 0:r.topicCardMetadata,displayName:this.props.displayName,personaCoinColor:(0,o.getPersonaInitialsColor)({text:this.props.displayName})},externalAppSessionCorrelationId:this.props.externalAppSessionCorrelationId,behavior:{onCardOpen:this._handleCardOpen,onCardClose:this.props.onCardClose,disableHover:this.props.disableHover,disableClick:this.props.disableClick,cardPlacementMode:this.props.cardPlacementMode},ariaLabel:this.props.ariaLabel},tabIndex:this.props.tabIndex},d=Boolean(this.props.legacyUpn||(null===(s=this.props.topicCardProps)||void 0===s?void 0:s.topicId)||this.props.upn||this.props.email);return d&&this._isLPCBundleLoaded()?t.createElement(a.livePersonaCardHoverTarget,(0,e.__assign)({},c,{onCardOpen:this._handleCardOpen}),t.Children.only(this.props.children)):d&&!this._isLPCBundleLoaded()?t.cloneElement(t.Children.only(this.props.children),{tabIndex:0,"data-is-focusable":!0,role:"button","aria-label":this.props.ariaLabel||(this.props.displayName?i.Text.format(_t.Ww,this.props.displayName):_t.qI),"aria-haspopup":"dialog"}):t.Children.only(this.props.children)},a.prototype._isLPCBundleLoaded=function(){return this.state.isBundleLoaded&&!!a.livePersonaCardHoverTarget},Object.defineProperty(a.prototype,"_logScenario",{get:function(){return this.props.clientScenario||"unset"},enumerable:!1,configurable:!0}),a.prototype._updateBundleMountedState=function(e){var t=this;this.setState({isBundleLoaded:!0},function(){return t._manuallyDispatchEventToTriggerCallout(e)})},Object.defineProperty(a.prototype,"_clientType",{get:function(){return this.props.clientType||"SPPeopleWebPart"},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"_personaType",{get:function(){return this.props.hostAppPersonaInfo&&this.props.hostAppPersonaInfo.PersonaType||"User"},enumerable:!1,configurable:!0}),a}(t.PureComponent);function vt(n){var a,r=i.Text.format(_t.dT,n.displayName||""),o=new URL(window.location.href).pathname.toLowerCase();return t.createElement(gt,(0,e.__assign)({ref:n.lpcRef},n,{ariaLabel:n.ariaLabel||r},-1!==o.toLowerCase().indexOf("_layouts/15/")&&{topicCardProps:(0,e.__assign)((0,e.__assign)({},n.topicCardProps),{topicCardMetadata:(0,e.__assign)((0,e.__assign)({},null===(a=n.topicCardProps)||void 0===a?void 0:a.topicCardMetadata),{hideFeedbackQuestions:!0,hideEntityAndContextQuestion:!0})})}))}var yt=function(){function e(){}return e.GetUtilities=function(){return e._promise||(e._promise=U.e(869).then(U.bind(U,373))),e._promise},e}();function St(e){return t.createElement("div",{className:"s_c_658c9e0a"},t.createElement(o.Icon,{className:"t_c_658c9e0a",iconName:e}))}function Dt(e){return"CanvasWebPartHost.Amplify.EmailEndpoint"===e}function It(e){return"CanvasWebPartHost.Amplify.TeamsEndpoint"===e}function xt(e){return Dt(e)||It(e)}function Ct(e){return"CanvasWebPartHost.Amplify.Main"===e}function Ot(e){return null==e?void 0:e.includes("CanvasWebPartHost.Amplify.")}c.loadStyles('.s_c_658c9e0a{background-color:"[theme:black, default: #000000]";cursor:pointer;height:100%;opacity:.5;position:absolute;text-align:center;top:0;width:100%;z-index:2}.t_c_658c9e0a{color:"[theme:white, default: #ffffff]";font-size:68px;position:absolute;top:50%;transform:translate(-50%,-50%)}[dir=ltr] .t_c_658c9e0a{left:50%}[dir=rtl] .t_c_658c9e0a{right:50%}',!0)})(),H})())})();